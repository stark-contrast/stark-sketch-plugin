var that=this;function __skpm_run(key,context){that.context=context;var exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(33),t),a(n(7),t),a(n(43),t),a(n(44),t),a(n(45),t),a(n(46),t),a(n(47),t),a(n(48),t)},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(34),t),a(n(16),t)},function(e,t){e.exports=require("sketch/dom")},function(e,t){e.exports=require("sketch")},function(e,t,n){var r,a,o=[];n(14)()?(o=[],r=function(e,t,n,r,a,i,s,l,c,u,d,f){var h=o.length;return o.push(coscript.scheduleWithInterval_jsFunction((t||0)/1e3,(function(){e(n,r,a,i,s,l,c,u,d,f)}))),h},a=function(e){var t=o[e];t&&(t.cancel(),o[e]=void 0)}):(r=function(e,t,n,r,i,s,l,c,u,d,f,h){coscript.shouldKeepAround=!0;var g=o.length;return o.push(!0),coscript.scheduleWithInterval_jsFunction((t||0)/1e3,(function(){o[g]&&e(n,r,i,s,l,c,u,d,f,h),a(g),o.every((function(e){return!e}))&&(coscript.shouldKeepAround=!1)})),g},a=function(e){o[e]=!1}),e.exports={setTimeout:r,clearTimeout:a}},function(e,t){e.exports={JS_BRIDGE:"__skpm_sketchBridge",JS_BRIDGE_RESULT_SUCCESS:"__skpm_sketchBridge_success",JS_BRIDGE_RESULT_ERROR:"__skpm_sketchBridge_error",START_MOVING_WINDOW:"__skpm_startMovingWindow",EXECUTE_JAVASCRIPT:"__skpm_executeJS",EXECUTE_JAVASCRIPT_SUCCESS:"__skpm_executeJS_success_",EXECUTE_JAVASCRIPT_ERROR:"__skpm_executeJS_error_"}},function(e,t){e.exports=require("sketch/settings")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyColorToLayer=t.getSelectionColors=t.getColorGroups=t.getChildLayers=t.getLayers=t.handleColorFgChange=t.handleColorBgChange=t.handleContrastUpdateButtonClicked=t.handleExpandCollapseClick=t.handleContrastSelectionChange=t.handleContrastLoaded=void 0;var r=n(8),a=n(1);Object.defineProperty(t,"getChildLayers",{enumerable:!0,get:function(){return a.getChildLayers}});var o,i,s=n(3),l=n(2),c=n(2).Style,u=!0,d=!0,f={r:255,g:255,b:255,a:1},h={r:255,g:255,b:255,a:1},g=[];t.handleContrastLoaded=function(){var e=a.getBrowserWindow(),t=s.getSelectedDocument().selectedLayers.layers,n=L();if(n=n,0===t.length)d=!0;else{var r=w();f=r.originalBgColor,h=r.originalFgColor,d=!1,o=r.backgroundLayer,i=r.foregroundLayer}var l={colorGroups:n,showErrorState:d,backgroundColor:f,foregroundColor:h};e.webContents.executeJavaScript("contrastLoaded('"+JSON.stringify(l)+"')").catch(console.error)},t.handleContrastSelectionChange=function(){var e=a.getBrowserWindow(),t=s.getSelectedDocument().selectedLayers.layers,n=L();if(n=n,0===t.length)d=!0,f={r:255,g:255,b:255,a:1},h={r:255,g:255,b:255,a:1};else{var r=w();f=r.originalBgColor,h=r.originalFgColor,d=!1,o=r.backgroundLayer,i=r.foregroundLayer}var l={colorGroups:n,showErrorState:d,backgroundColor:f,foregroundColor:h};e.webContents.executeJavaScript("contrastLoaded('"+JSON.stringify(l)+"')").catch(console.error)},t.handleExpandCollapseClick=function(){u?(a.setWindowBounds(360,471),u=!1):(a.setWindowBounds(360,651),u=!0)},t.handleContrastUpdateButtonClicked=function(e){var t=a.getBrowserWindow();try{a.debug(e);var n=JSON.parse(e);a.debug(n),x(r.ConvertRgbaToHex(n.background,!0,!0),o),x(r.ConvertRgbaToHex(n.foreground,!0,!0),i),f=n.background,h=n.foreground;var s=N();s.length>0&&g.length>0?"Selection Colors"===g[0].name?g[0].subgroups[0].colors=s:g.unshift({name:"Selection Colors",subgroups:[{name:"",colors:s}]}):"Selection Colors"===g[0].name&&g.shift();var l={colorGroups:g,backgroundColor:f,foregroundColor:h};t.webContents.executeJavaScript("contrastLoaded('"+JSON.stringify(l)+"')").catch(console.error)}catch(e){a.debug(e)}},t.handleColorBgChange=function(e){var t=a.getBrowserWindow(),n=JSON.parse(e).bgColor;f=n,d=!1;var r={showErrorState:!1,backgroundColor:n};t.webContents.executeJavaScript("contrastLoaded('"+JSON.stringify(r)+"')").catch(console.error)},t.handleColorFgChange=function(e){var t=a.getBrowserWindow(),n=JSON.parse(e).fgColor;h=n,d=!1;var r={showErrorState:!1,foregroundColor:n};t.webContents.executeJavaScript("contrastLoaded('"+JSON.stringify(r)+"')").catch(console.error)};var m=function(e){return"Artboard"===e.type||"Shape"===e.type||"ShapePath"===e.type||"Image"===e.type||"Text"===e.type},p=function(e){var t=!1;return m(e)&&("Artboard"===e.type||e.style.fills)&&(t=!0),t},S=function(e){return l.find("Text",e).filter((function(e){return v([e]).length>0}))},y=function(e){var t=[],n=l.find("Artboard",e),r=l.find("Shape",e),a=l.find("ShapePath",e),o=l.find("Image",e);return(t=t.concat(n,r,a,o)).filter((function(e){return v([e]).length>0}))},v=function(e){var t=[];return e.forEach((function(e){if(m(e))if("Artboard"===e.type)e.background?t.push(r.ConvertHexToRgba(e.background.color)):t.push({r:255,g:255,b:255,a:1});else if("Shape"===e.type||"ShapePath"===e.type||"Image"===e.type)e.style.fills.forEach((function(e){e.fillType===c.FillType.Color&&t.push(r.ConvertHexToRgba(e.color))}));else if("Text"===e.type)if(e.style.fills.length>0)e.style.fills.forEach((function(e){e.fillType===c.FillType.Color&&t.push(r.ConvertHexToRgba(e.color))}));else{var n=e.sketchObject.textColor();t.push({r:255*n.red(),g:255*n.green(),b:255*n.blue(),a:n.alpha()})}})),t},b=function(e){var t,n=function(e){if(e.parent&&p(e.parent))t=e.parent;else{if("Page"===e.parent.type)return;n(e.parent)}};return n(e),t},T=function(){var e=s.getSelectedDocument(),t=e.selectedPage,n=e.selectedLayers.layers,r={bgLayer:t,fgLayer:t};try{return 1===n.length?function(e){var t=s.getSelectedDocument().selectedPage,n={bgLayer:t,fgLayer:t};try{if(a.isLayerGroup(e)){var r=S(e),o=y(e);r.length>0?(n.fgLayer=r[0],0===o.length?n.bgLayer=b(r[0]):n.bgLayer=o[0]):o.length>0&&(n.fgLayer=o[0],o.length>1&&(n.bgLayer=o[1]))}else n.bgLayer=b(e),p(e)&&(n.fgLayer=e);return n}catch(e){return a.debug(e),n}}(n[0]):2===n.length?function(e){var t=s.getSelectedDocument().selectedPage,n={bgLayer:t,fgLayer:t};if("Text"===e[0].type)n.fgLayer=e[0],p(e[1])?n.bgLayer=e[1]:a.isLayerGroup(e[1])&&(o=y(e[1])).length>0&&(n.bgLayer=o[0]);else if("Text"===e[1].type)n.fgLayer=e[1],p(e[0])?n.bgLayer=e[0]:a.isLayerGroup(e[0])&&(o=y(e[0])).length>0&&(n.bgLayer=o[0]);else if(p(e[0]))n.fgLayer=e[0],p(e[1])?n.bgLayer=e[1]:a.isLayerGroup(e[1])&&(o=y(e[1])).length>0&&(n.bgLayer=o[0]);else if(p(e[1]))n.bgLayer=e[1],p(e[0])?n.bgLayer=e[0]:a.isLayerGroup(e[0])&&(o=y(e[0])).length>0&&(n.bgLayer=o[0]);else if(a.isLayerGroup(e[0])){var r=S(e[0]),o=y(e[0]),i=y(e[1]);r.length>0?(n.fgLayer=r[0],i.length>0?n.bgLayer=i[0]:o.length>0&&(n.bgLayer=o[0])):i.length>0?n.fgLayer=i[0]:o.length>0&&(n.bgLayer=o[0])}else a.isLayerGroup(e[1])&&(r=S(e[1]),o=y(e[1]),i=y(e[0]),r.length>0?(n.fgLayer=r[0],i.length>0?n.bgLayer=i[0]:o.length>0&&(n.bgLayer=o[0])):i.length>0?n.fgLayer=i[0]:o.length>0&&(n.bgLayer=o[0]));return n}(n):function(e){var t=s.getSelectedDocument().selectedPage,n={bgLayer:t,fgLayer:t},r=[];if(e.every((function(e){if(r.length>0)return!1;if("Text"===e.type&&p(e))r.push(e);else if(a.isLayerGroup(e)){var t=a.getChildLayers(e,!1);t.length>0&&t.forEach((function(e){"Text"===e.type&&p(e)&&r.push(e)}))}return!0})),r.length>0){n.fgLayer=r[0];var o=[];e.every((function(e){if(o.length>0)return!1;if("Text"!==e.type&&p(e))o.push(e);else if(a.isLayerGroup(e)){var t=a.getChildLayers(e,!1);t.length>0&&t.forEach((function(t){"Text"!==e.type&&p(t)&&o.push(t)}))}return!0})),o.length>0&&(n.bgLayer=o[0])}else{var i=[];e.forEach((function(e){if("Text"!==e.type&&p(e))i.push(e);else if(a.isLayerGroup(e)){var t=a.getChildLayers(e,!1);t.length>0&&t.forEach((function(t){"Text"!==e.type&&p(t)&&i.push(t)}))}return!0})),1===i.length?n.fgLayer=i[0]:i.length>1&&(n.fgLayer=i[0],n.bgLayer=i[1])}return n}(n)}catch(e){return a.debug(e),r}},w=function(){try{var e=T(),t=v([e.bgLayer]),n=v([e.fgLayer]),o=t[0],i=o,s=n[0],l=s;return o.a<1&&(i=r.MixColors(s,o)),s.a<1&&(l=r.MixColors(o,s)),{backgroundLayer:e.bgLayer,originalBgColor:o,normalizedBgColor:i,foregroundLayer:e.fgLayer,originalFgColor:s,normalizedFgColor:l}}catch(e){a.debug(e)}};t.getLayers=w;var C=function(e){return"#"+r.ConvertRgbaToHex(e).toUpperCase()+" / rgba("+Math.floor(e.r)+", "+Math.floor(e.g)+", "+Math.floor(e.b)+", "+Math.floor(e.a)+")"},N=function(){var e=[],t=[];s.getSelectedDocument().selectedLayers.layers.forEach((function(e){if(a.isLayerGroup(e)){var n=a.getChildLayers(e,!0);t=t.concat(n)}else t.push(e)}));var n=v(t),o=n.map((function(e){return r.ConvertRgbaToRgbaString(e)}));return n.filter((function(e,t){return!o.includes(r.ConvertRgbaToRgbaString(e),t+1)})).forEach((function(t){e.push({name:C(t),color:t})})),e};t.getSelectionColors=N;var L=function(){var e=[],t=N();t.length>0&&e.push({name:"Selection Colors",subgroups:[{name:"",colors:t}]});var n=function(){var e=[],t=s.getSelectedDocument().colors;return t&&t.length>0&&t.forEach((function(t){var n,a={name:null===(n=null==t?void 0:t.name)||void 0===n?void 0:n.replace("'",""),color:r.ConvertHexToRgba(t.color)};e.push(a)})),e}();n.length>0&&e.push({name:"Document Color Assets",subgroups:[{name:"",colors:n}]});var o=function(){var e=[],t=s.getSelectedDocument().swatches;return t&&t.length>0&&t.forEach((function(t){var n,a={name:null===(n=null==t?void 0:t.name)||void 0===n?void 0:n.replace("'",""),color:r.ConvertHexToRgba(t.color)};e.push(a)})),e}();o.length>0&&e.push({name:"Document Swatches",subgroups:[{name:"",colors:o}]});var i=function(){var e=[],t=s.getSelectedDocument().sharedLayerStyles;return t&&t.length>0&&t.forEach((function(t){var n,a,o,i;if(t.style.fills.length>0&&t.style.fills[0].fillType===c.FillType.Color){var s={name:null===(a=null===(n=null==t?void 0:t.style)||void 0===n?void 0:n.name)||void 0===a?void 0:a.replace("'",""),color:r.ConvertHexToRgba(t.style.fills[0].color)};e.push(s)}else t.textColor&&(s={name:null===(i=null===(o=null==t?void 0:t.style)||void 0===o?void 0:o.name)||void 0===i?void 0:i.replace("'",""),color:r.ConvertHexToRgba(t.textColor)},e.push(s))})),e}();i.length>0&&e.push({name:"Document Styles",subgroups:[{name:"",colors:i}]});var l=function(){var e=[],t=s.globalAssets.colors;return t&&t.length>0&&t.forEach((function(t){var n,a={name:null===(n=null==t?void 0:t.name)||void 0===n?void 0:n.replace("'",""),color:r.ConvertHexToRgba(t.color)};e.push(a)})),e}();l.length>0&&e.push({name:"Global Color Assets",subgroups:[{name:"",colors:l}]});var u=function(){var e=[],t=s.globalAssets.swatches;return t&&t.length>0&&t.forEach((function(t){var n,a={name:null===(n=null==t?void 0:t.name)||void 0===n?void 0:n.replace("'",""),color:r.ConvertHexToRgba(t.color)};e.push(a)})),e}();u.length>0&&e.push({name:"Global Swatches",subgroups:[{name:"",colors:u}]});var d=function(){var e=[],t=s.getSelectedDocument().selectedPage,n=a.getChildLayers(t,!1);if(n&&n.length>0){var o=v(n);if(o&&o.length>0){var i=o.map((function(e){return r.ConvertRgbaToRgbaString(e)}));o.filter((function(e,t){return!i.includes(r.ConvertRgbaToRgbaString(e),t+1)})).forEach((function(t){var n={name:C(t),color:t};e.push(n)}))}}return e}();return d.length>0&&e.push({name:"Page Colors",subgroups:[{name:"",colors:d}]}),e};t.getColorGroups=L;var x=function(e,t){if("Text"===t.type){var n=MSImmutableColor.colorWithSVGString_(e),r=MSColor.alloc().initWithImmutableObject_(n);t.sketchObject.setTextColor(r)}else"Artboard"===t.type?(t.background.enabled=!0,t.background.color=e):t.style.fills=[{color:e,fillType:c.FillType.Color}]};t.applyColorToLayer=x},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&("get"in a?t.__esModule:!a.writable&&!a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),a(n(37),t),a(n(17),t),a(n(20),t),a(n(38),t),a(n(39),t),a(n(40),t),a(n(18),t),a(n(9),t),a(n(41),t),a(n(19),t),a(n(42),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertRgbaToHex=t.ConvertRgbaToBaseHsla=t.ConvertRgbaToHsla=t.ConvertRgbaToBaseRgba=t.ConvertBaseRgbaToRgba=t.ConvertRgbaStringToBaseRgba=t.ConvertRgbaStringToRgba=t.ConvertBaseRgbaToRgbaString=t.ConvertRgbaToRgbaString=void 0;var r=n(19);t.ConvertRgbaToRgbaString=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a?e.a:1,")")},t.ConvertBaseRgbaToRgbaString=function(e){return"rgba(".concat(Math.round(255*e.r),", ").concat(Math.round(255*e.g),", ").concat(Math.round(255*e.b),", ").concat(e.a?e.a:1,")")},t.ConvertRgbaStringToRgba=function(e){var t=r.RGBA_REGEX,n=e.match(t);return n&&(null==n?void 0:n.length)>0?{r:Number(n[1]),g:Number(n[2]),b:Number(n[3]),a:Number(n[4])}:{r:0,g:0,b:0,a:0}},t.ConvertRgbaStringToBaseRgba=function(e){var t=r.RGBA_REGEX,n=e.match(t);return n&&(null==n?void 0:n.length)>0?{r:Number(n[1])/255,g:Number(n[2])/255,b:Number(n[3])/255,a:Number(n[4])}:{r:0,g:0,b:0,a:0}},t.ConvertBaseRgbaToRgba=function(e,t){var n=e.a?e.a:1;return{r:255*e.r,g:255*e.g,b:255*e.b,a:t?255*n:n}},t.ConvertRgbaToBaseRgba=function(e,t){var n=e.a?e.a:255;return{r:e.r/255,g:e.g/255,b:e.b/255,a:t?n/255:n}},t.ConvertRgbaToHsla=function(e){var t,n=e.r/255,r=e.g/255,a=e.b/255,o=Math.max(n,r,a),i=Math.min(n,r,a),s=0,l=(o+i)/2;if(o===i)s=t=0;else{var c=o-i;switch(t=l>.5?c/(2-o-i):c/(o+i),o){case n:s=(r-a)/c+(r<a?6:0);break;case r:s=(a-n)/c+2;break;case a:s=(n-r)/c+4}s/=6}return{h:Math.round(360*s),s:Math.round(100*t),l:Math.round(100*l),a:e.a}},t.ConvertRgbaToBaseHsla=function(e){var t,n=e.r/255,r=e.g/255,a=e.b/255,o=Math.max(n,r,a),i=Math.min(n,r,a),s=0,l=(o+i)/2;if(o===i)s=t=0;else{var c=o-i;switch(t=l>.5?c/(2-o-i):c/(o+i),o){case n:s=(r-a)/c+(r<a?6:0);break;case r:s=(a-n)/c+2;break;case a:s=(n-r)/c+4}s/=6}return{h:s,s:t,l:l,a:e.a}},t.ConvertRgbaToHex=function(e,t,n){var r=function(e){return 1===e.length?"0"+e:""+e};return"".concat(t?"#":"").concat(r(Math.round(e.r).toString(16))).concat(r(Math.round(e.g).toString(16))).concat(r(Math.round(e.b).toString(16))).concat(n&&e.a?r(Math.round(255*e.a).toString(16)):"")}},function(e,t,n){var r=n(11),a=n(22),o=n(23),i=n(25),s=n(26),l=n(27),c=n(28),u=n(12),d=n(29);function f(e){var t=(e=e||{}).identifier||NSUUID.UUID().UUIDString(),n=NSThread.mainThread().threadDictionary(),h=f.fromId(t);if(h)return h;var g=new r;if(g.id=t,e.modal&&!e.parent)throw new Error("A modal needs to have a parent.");var m=coscript.createFiber(),p=e.width||800,S=e.height||600,y=NSScreen.screens().firstObject().frame(),v=NSMakeRect(void 0!==e.x?e.x:Math.round((NSWidth(y)-p)/2),void 0!==e.y?NSHeight(y)-e.y:Math.round((NSHeight(y)-S)/2),p,S);e.titleBarStyle&&"default"!==e.titleBarStyle&&(e.frame=!1);var b="textured"!==e.windowType,T=NSTitledWindowMask;!1!==e.minimizable&&(T|=NSMiniaturizableWindowMask),!1!==e.closable&&(T|=NSClosableWindowMask),!1!==e.resizable&&(T|=NSResizableWindowMask),b&&!e.transparent&&!1!==e.frame||(T|=NSTexturedBackgroundWindowMask);var w=NSPanel.alloc().initWithContentRect_styleMask_backing_defer(v,T,NSBackingStoreBuffered,!0),C=WKWebViewConfiguration.alloc().init(),N=WKWebView.alloc().initWithFrame_configuration(CGRectMake(0,0,e.width||800,e.height||600),C);if(l(N),N.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),a(g,w,N),o(g,w,N),d(g,w,N,e),"desktop"===e.windowType&&(w.setLevel(kCGDesktopWindowLevel-1),w.setCollectionBehavior(NSWindowCollectionBehaviorCanJoinAllSpaces|NSWindowCollectionBehaviorStationary|NSWindowCollectionBehaviorIgnoresCycle)),void 0===e.minWidth&&void 0===e.minHeight||g.setMinimumSize(e.minWidth||0,e.minHeight||0),void 0===e.maxWidth&&void 0===e.maxHeight||g.setMaximumSize(e.maxWidth||1e4,e.maxHeight||1e4),e.transparent||!1===e.frame){w.titlebarAppearsTransparent=!0,w.titleVisibility=NSWindowTitleHidden,w.setOpaque(0),w.isMovableByWindowBackground=!0;var L=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");L.setShowsBaselineSeparator(!1),w.setToolbar(L)}if("hiddenInset"===e.titleBarStyle){var x=NSToolbar.alloc().initWithIdentifier("titlebarStylingToolbar");x.setShowsBaselineSeparator(!1),w.setToolbar(x)}!1!==e.frame&&e.useContentSize||g.setSize(p,S),e.center&&g.center(),e.alwaysOnTop&&g.setAlwaysOnTop(!0),e.fullscreen&&g.setFullScreen(!0),g.setFullScreenable(!!e.fullscreenable);let E=e.title;!1===e.frame?E=void 0:void 0===E&&"undefined"!=typeof __command&&__command.pluginBundle()&&(E=__command.pluginBundle().name()),E&&g.setTitle(E);var _=e.backgroundColor;e.transparent&&(_=NSColor.clearColor()),!_&&!1===e.frame&&e.vibrancy&&(_=NSColor.clearColor()),g._setBackgroundColor(_||NSColor.windowBackgroundColor()),!1===e.hasShadow&&g.setHasShadow(!1),void 0!==e.opacity&&g.setOpacity(e.opacity),e.webPreferences=e.webPreferences||{},N.configuration().preferences().setValue_forKey(!1!==e.webPreferences.devTools,"developerExtrasEnabled"),N.configuration().preferences().setValue_forKey(!1!==e.webPreferences.javascript,"javaScriptEnabled"),N.configuration().preferences().setValue_forKey(!!e.webPreferences.plugins,"plugInsEnabled"),N.configuration().preferences().setValue_forKey(e.webPreferences.minimumFontSize||0,"minimumFontSize"),e.webPreferences.zoomFactor&&N.setMagnification(e.webPreferences.zoomFactor);var I=w.contentView();return!1!==e.frame?(N.setFrame(I.bounds()),I.addSubview(N)):(I.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),i(I,I.superview()),N.setFrame(I.bounds()),I.addSubview(N),w.standardWindowButton(NSWindowFullScreenButton)&&w.standardWindowButton(NSWindowFullScreenButton).setHidden(!0),e.titleBarStyle&&"default"!==e.titleBarStyle||(w.standardWindowButton(NSWindowZoomButton).setHidden(!0),w.standardWindowButton(NSWindowMiniaturizeButton).setHidden(!0),w.standardWindowButton(NSWindowCloseButton).setHidden(!0),w.standardWindowButton(NSWindowZoomButton).setEnabled(!1))),e.vibrancy&&g.setVibrancy(e.vibrancy),g.setMaximizable(!1!==e.maximizable),w.setHidesOnDeactivate(!1!==e.hidesOnDeactivate),e.remembersWindowFrame&&(w.setFrameAutosaveName(t),w.setFrameUsingName_force(w.frameAutosaveName(),!1)),e.acceptsFirstMouse&&g.on("focus",(function(e){e.type()===NSEventTypeLeftMouseDown&&g.webContents.executeJavaScript(s(N,e)).catch(()=>{})})),u.injectScript(N),c.injectScript(N),c.setupHandler(g),!1!==e.show&&g.show(),g.on("closed",(function(){g._destroyed=!0,n.removeObjectForKey(t);var e=n[t+".themeObserver"];e&&(NSApplication.sharedApplication().removeObserver_forKeyPath(e,"effectiveAppearance"),n.removeObjectForKey(t+".themeObserver")),m.cleanup()})),n[t]=w,m.onCleanup((function(){g._destroyed||g.destroy()})),g}f.fromId=function(e){var t=NSThread.mainThread().threadDictionary();if(t[e])return f.fromPanel(t[e],e)},f.fromPanel=function(e,t){var n=new r;if(n.id=t,!e||!e.contentView)throw new Error("needs to pass an NSPanel");for(var i=null,s=e.contentView().subviews(),l=0;l<s.length;l+=1)i||s[l].isKindOfClass(WKInspectorWKWebView)||!s[l].isKindOfClass(WKWebView)||(i=s[l]);if(!i)throw new Error("The panel needs to have a webview");return a(n,e,i),o(n,e,i),n},e.exports=f},function(e,t){e.exports=require("events")},function(e,t,n){(function(t){var r=n(5);e.exports=function(n,a){return function o(i,s,l){"function"==typeof s&&(l=s,s=!1);var c=coscript.createFiber();return n.navigationDelegate().state&&0==n.navigationDelegate().state.wasReady?new t((function(e,t){a.once("ready-to-show",(function(){o(i,s,l).then(e).catch(t),c.cleanup()}))})):new t((function(t,o){var s=Math.random();a.webContents.on(r.EXECUTE_JAVASCRIPT_SUCCESS+s,(function(e){try{l&&l(null,e),t(e)}catch(e){o(e)}c.cleanup()})),a.webContents.on(r.EXECUTE_JAVASCRIPT_ERROR+s,(function(e){try{l?(l(e),t()):o(e)}catch(e){o(e)}c.cleanup()})),n.evaluateJavaScript_completionHandler(e.exports.wrapScript(i,s),null)}))}},e.exports.wrapScript=function(e,t){return"window."+r.EXECUTE_JAVASCRIPT+"("+t+", "+JSON.stringify(e)+")"},e.exports.injectScript=function(e){var t="window."+r.EXECUTE_JAVASCRIPT+' = function(id, script) {  try {    var res = eval(script);    if (res && typeof res.then === "function" && typeof res.catch === "function") {      res.then(function (res2) {        window.postMessage("'+r.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res2);      })      .catch(function (err) {        window.postMessage("'+r.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);      })    } else {      window.postMessage("'+r.EXECUTE_JAVASCRIPT_SUCCESS+'" + id, res);    }  } catch (err) {    window.postMessage("'+r.EXECUTE_JAVASCRIPT_ERROR+'" + id, err);  }}',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}}).call(this,n(13))},function(e,t,n){"use strict";(function(t,n){var r=t;function a(e){return Boolean(e&&void 0!==e.length)}function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function s(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void c(t.promise,e)}l(t.promise,r)}else(1===e._state?l:c)(t.promise,e._value)}))):e._deferreds.push(t)}function l(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void u(e);if("function"==typeof n)return void d(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,u(e)}catch(t){c(e,t)}}function c(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn((function(){e._handled||i._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function d(e,t){var n=!1;try{e((function(e){n||(n=!0,l(t,e))}),(function(e){n||(n=!0,c(t,e))}))}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return s(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},i.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))},i.all=function(e){return new i((function(t,n){if(!a(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function i(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,(function(t){i(e,t)}),n)}r[e]=a,0==--o&&t(r)}catch(e){n(e)}}for(var s=0;s<r.length;s++)i(s,r[s])}))},i.allSettled=function(e){return new this((function(t,n){if(!e||void 0===e.length)return n(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var a=r.length;function o(e,n){if(n&&("object"==typeof n||"function"==typeof n)){var i=n.then;if("function"==typeof i)return void i.call(n,(function(t){o(e,t)}),(function(n){r[e]={status:"rejected",reason:n},0==--a&&t(r)}))}r[e]={status:"fulfilled",value:n},0==--a&&t(r)}for(var i=0;i<r.length;i++)o(i,r[i])}))},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i((function(t){t(e)}))},i.reject=function(e){return new i((function(t,n){n(e)}))},i.race=function(e){return new i((function(t,n){if(!a(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)i.resolve(e[r]).then(t,n)}))},i._immediateFn="function"==typeof n&&function(e){n(e)}||function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=i}).call(this,n(4).setTimeout,n(24).setImmediate)},function(e,t){e.exports=function(){return"undefined"!=typeof coscript&&coscript.createFiber}},function(e,t,n){var r,a,o=[];n(14)()?(r=function(e,t,n,r,a,i,s,l,c,u,d,f){var h=o.length;return o.push(coscript.scheduleWithRepeatingInterval_jsFunction((t||0)/1e3,(function(){e(n,r,a,i,s,l,c,u,d,f)}))),h},a=function(e){var t=o[e];t&&(t.cancel(),o[e]=void 0)}):(r=function(e,t,n,r,a,i,s,l,c,u,d,f){coscript.shouldKeepAround=!0;var h=o.length;return o.push(!0),function g(){coscript.scheduleWithInterval_jsFunction((t||0)/1e3,(function(){o[h]&&(e(n,r,a,i,s,l,c,u,d,f),g())}))}(),h},a=function(e){o[e]=!1,o.every((function(e){return!e}))&&(coscript.shouldKeepAround=!1)}),e.exports={setInterval:r,clearInterval:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SETTINGS_CONTRASTMODEL=t.SETTINGS_DEFAULTCOLORFORMAT=t.SETTINGS_DEFAULTTOOL=t.SETTINGS_GENERATORTRIESLEFT=t.SETTINGS_CONTRASTSUGGESTIONSTRIESLEFT=t.SETTINGS_CONTRASTFAILMESSAGESHOWN=t.SETTINGS_OPTINUSAGEDATA=t.SETTINGS_MIXPANELID=t.SETTINGS_TEAMPLANSTATUS=t.SETTINGS_TEAMUSER=t.SETTINGS_PLAN=t.SETTINGS_EMAIL=t.SETTINGS_STATUS=t.SETTINGS_USERID=void 0,t.SETTINGS_USERID="user_id",t.SETTINGS_STATUS="subscription-status",t.SETTINGS_EMAIL="email",t.SETTINGS_PLAN="plan",t.SETTINGS_TEAMUSER="teamUser",t.SETTINGS_TEAMPLANSTATUS="teamPlanStatus",t.SETTINGS_MIXPANELID="mp_id",t.SETTINGS_OPTINUSAGEDATA="optInUsageData",t.SETTINGS_CONTRASTFAILMESSAGESHOWN="contrast-fail-message-shown",t.SETTINGS_CONTRASTSUGGESTIONSTRIESLEFT="suggestions-tries-left",t.SETTINGS_GENERATORTRIESLEFT="generator-tries-left",t.SETTINGS_DEFAULTTOOL="stark_default_tool",t.SETTINGS_DEFAULTCOLORFORMAT="stark_default_color_format",t.SETTINGS_CONTRASTMODEL="stark_contrast_model"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LightenColor=t.DarkenColor=void 0;var r=n(18),a=n(9);t.DarkenColor=function(e,t){var n=(0,a.ConvertRgbaToBaseHsla)(e);return n.l-=t,n.l<0&&(n.l=0),(0,r.ConvertBaseHslaToRgba)(n)},t.LightenColor=function(e,t){var n=(0,a.ConvertRgbaToBaseHsla)(e);return n.l+=t,n.l>1&&(n.l=1),(0,r.ConvertBaseHslaToRgba)(n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertBaseHslaToRgba=void 0,t.ConvertBaseHslaToRgba=function(e){var t,n,r,a=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e};if(0===e.s)t=n=r=e.l;else{var o=e.l<.5?e.l*(1+e.s):e.l+e.s-e.l*e.s,i=2*e.l-o;t=a(i,o,e.h+1/3),n=a(i,o,e.h),r=a(i,o,e.h-1/3)}return{r:Math.round(255*t),g:Math.round(255*n),b:Math.round(255*r),a:e.a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BLURRED=t.CB_ACHROLY=t.CB_ACHRO=t.CB_TRITALY=t.CB_TRITA=t.CB_DEUTERLY=t.CB_DEUTER=t.CB_PROTALY=t.CB_PROTA=t.RGBA_REGEX=void 0,t.RGBA_REGEX=/rgba?\((\d+.?\d+|\d),\s*(\d+.?\d+|\d),\s*(\d+.?\d+|\d),\s*(\d+.?\d+|\d)?\)/,t.CB_PROTA="Protanopia",t.CB_PROTALY="Protanomaly",t.CB_DEUTER="Deuteranopia",t.CB_DEUTERLY="Deuteranomaly",t.CB_TRITA="Tritanopia",t.CB_TRITALY="Tritanomaly",t.CB_ACHRO="Achromatopsia",t.CB_ACHROLY="Achromatomaly",t.BLURRED="Blurred"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetContrastRatio=void 0,t.GetContrastRatio=function(e,t,n){var r=function(e){var t,n,r;return t=e.r/255,n=e.g/255,r=e.b/255,.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},a=(Math.max(r(e),r(t))+.05)/(Math.min(r(e),r(t))+.05);if(n){var o=String(a);if(-1!==o.indexOf(".")){var i=o.split(".");a=1===i.length?Number(o):Number(i[0]+"."+i[1].charAt(0)+i[1].charAt(1))}a=Number(a.toFixed(2))}return a}},function(e,t,n){"use strict";n.r(t),n.d(t,"onSelectionChanged",(function(){return l}));var r=n(10),a=n.n(r),o=n(0),i=n(1),s="Main";function l(e){var t=i.getBrowserWindow().getTitle();"Contrast"===t?o.handleContrastSelectionChange():"Touch Targets"===t&&o.handleTouchTargetsSelectionChanged()}t.default=function(){var e=new a.a({identifier:"stark.main",frame:!1,height:473,width:360,resizable:!1,hidesOnDeactivate:!0,alwaysOnTop:!0,remembersWindowFrame:!0,acceptsFirstMouse:!0,title:"Main",backgroundColor:"#FFF",show:!1}),t=e.webContents;e.once("ready-to-show",(function(){e.show()})),t.on("did-finish-load",(function(){var e=i.loadAllSettings(),n=i.loadSetting(i.SETTINGS_DEFAULTTOOL),r=i.loadSetting(i.SETTINGS_DEFAULTCOLORFORMAT),a=i.loadSetting(i.SETTINGS_CONTRASTMODEL);if(n){var l=i.convertDefaultTool(n);s=l}o.handleMenuItemClick(s);var c={pluginUserData:e,pluginAppSettings:{selectedMenuItem:s,defaultColorFormat:r,defaultTool:n,contrastModel:a}};t.executeJavaScript("prepareFirstLoad(".concat(JSON.stringify(c),")")).catch(console.error)})),t.on("urlClicked",(function(e){i.openURL(e)})),t.on("minMaxButtonClicked",(function(){o.handleMinMaxButtonClicked()})),t.on("cancelButtonClicked",(function(){e.close()})),t.on("menuItemClicked",(function(e){var t=JSON.parse(e);s=t.menuItem,o.handleMenuItemClick(t.menuItem)})),t.on("messageReceived",(function(e){o.handleMessageReceivedFromSocket(e)})),t.on("contrastLoaded",(function(){o.handleContrastLoaded()})),t.on("handleExpandCollapseClick",(function(){o.handleExpandCollapseClick()})),t.on("contrastUpdateButtonClicked",(function(e){o.handleContrastUpdateButtonClicked(e)})),t.on("colorBgChange",(function(e){o.handleColorBgChange(e)})),t.on("colorFgChange",(function(e){o.handleColorFgChange(e)})),t.on("typographyLoaded",(function(){o.handleTypographyLoaded()})),t.on("typographyItemClick",(function(e){o.handleTypographyItemClick(e)})),t.on("applyFontSizeChange",(function(e){o.handleApplyFontSizeChange(e)})),t.on("altTextLoaded",(function(){o.handleAltTextLoaded()})),t.on("addAltTextItem",(function(e){o.handleAddAltTextItem(e)})),t.on("deleteAltTextItem",(function(e){o.handleDeleteAltTextItem(e)})),t.on("touchTargetsLoaded",(function(){o.handleTouchTargetsLoaded()})),t.on("focusOrderLoaded",(function(){o.handleFocusOrderLoaded()})),t.on("createSequence",(function(e){o.handleCreateSequence(e)})),t.on("selectSequence",(function(e){o.handleSelectSequence(e)})),t.on("moveSequence",(function(e){o.handleMoveSequence(e)})),t.on("saveNameSequence",(function(e){o.handleSaveNameSequence(e)})),t.on("deleteSequence",(function(e){o.handleDeleteSequence(e)})),t.on("addFocusItem",(function(){o.handleAddFocusItem()})),t.on("deleteFocusItem",(function(e){o.handleDeleteFocusItem(e)})),t.on("saveNameFocusItem",(function(e){o.handleSaveNameFocusItem(e)})),t.on("moveFocusItem",(function(e){o.handleMoveFocusItem(e)})),t.on("landmarksLoaded",(function(){o.handleLandmarksLoaded()})),t.on("addLandmarkItem",(function(e){o.handleAddLandmarkItem(e)})),t.on("deleteLandmarkItem",(function(e){o.handleDeleteLandmarkItem(e)})),t.on("visionSimulatorLoaded",(function(){o.handleVisionSimulatorLoaded()})),t.on("simulationTabLoaded",(function(){o.handleSimulationTabLoaded()})),t.on("artboardChanged",(function(e){o.handleArtboardChanged(e)})),t.on("generate",(function(e){o.handleGenerate(e)})),t.on("defaultToolChanged",(function(e){var t=JSON.parse(e);i.saveSetting(i.SETTINGS_DEFAULTTOOL,t.tool)})),t.on("defaultColorFormatChanged",(function(e){var t=JSON.parse(e);i.saveSetting(i.SETTINGS_DEFAULTCOLORFORMAT,t.colorFormat)})),t.on("contrastModelChanged",(function(e){var t=JSON.parse(e);i.saveSetting(i.SETTINGS_CONTRASTMODEL,t.contrastModel)})),t.on("signoutButtonClicked",(function(){i.clearAllSettings()})),t.on("validationSuccessful",(function(e){i.updateSubscription(e)})),t.on("validationFailed",(function(){i.clearAllSettings()})),t.on("activationSuccessful",(function(e){var t=JSON.parse(e);i.debug(t),i.saveAllSettings(t.validationObject)})),e.loadURL(n(49))}},function(e,t){e.exports=function(e,t,n){function r(n){e.isVisible()&&(n?(NSApplication.sharedApplication().activateIgnoringOtherApps(!0),t.makeKeyAndOrderFront(null)):(t.orderBack(null),NSApp.mainWindow().makeKeyAndOrderFront(null)))}e._panel=t,e._webview=n,e._destroyed=!1,e.destroy=function(){return t.close()},e.close=function(){if(t.delegate().utils&&t.delegate().utils.parentWindow){var n=!0;return e.emit("close",{get defaultPrevented(){return!n},preventDefault:function(){n=!1}}),void(n&&t.delegate().utils.parentWindow.endSheet(t))}e.isClosable()&&t.performClose(null)},e.focus=r.bind(this,!0),e.blur=r.bind(this,!1),e.isFocused=function(){return t.isKeyWindow()},e.isDestroyed=function(){return e._destroyed},e.show=function(){return NSApp.activateIgnoringOtherApps(!0),t.delegate().utils&&t.delegate().utils.parentWindow?t.delegate().utils.parentWindow.beginSheet_completionHandler(t,__mocha__.createBlock_function("v16@?0q8",(function(){e.emit("closed")}))):t.makeKeyAndOrderFront(null)},e.showInactive=function(){return t.orderFrontRegardless()},e.hide=function(){return t.orderOut(null)},e.isVisible=function(){return t.isVisible()},e.isModal=function(){return!1},e.maximize=function(){e.isMaximized()||t.zoom(null)},e.unmaximize=function(){e.isMaximized()&&t.zoom(null)},e.isMaximized=function(){if(0!=(t.styleMask()&NSResizableWindowMask))return t.isZoomed();var e=NSScreen.mainScreen().visibleFrame(),n=t.frame();return e.origin.x==n.origin.x&&e.origin.y==n.origin.y&&e.size.width==n.size.width&&e.size.height==n.size.height},e.minimize=function(){return t.miniaturize(null)},e.restore=function(){return t.deminiaturize(null)},e.isMinimized=function(){return t.isMiniaturized()},e.setFullScreen=function(n){n!==e.isFullscreen()&&t.toggleFullScreen(null)},e.isFullscreen=function(){return t.styleMask()&NSFullScreenWindowMask},e.setAspectRatio=function(e){e>0?t.setAspectRatio(NSMakeSize(e,1)):t.setResizeIncrements(NSMakeSize(1,1))},e.setBounds=function(n,r){if(!n)return;if(e.isFullscreen())return;const a=Object.assign(e.getBounds(),n);var o=NSMakeRect(a.x,0,a.width,a.height),i=NSScreen.screens().firstObject();o.origin.y=NSHeight(i.frame())-a.y,t.setFrame_display_animate(o,!0,r)},e.getBounds=function(){const e=t.frame();var n=NSScreen.screens().firstObject().frame();return{x:e.origin.x,y:Math.round(NSHeight(n)-e.origin.y),width:e.size.width,height:e.size.height}},e.setContentBounds=function(t,n){e.setBounds(t,n)},e.getContentBounds=function(){return e.getBounds()},e.setSize=function(t,n,r){return e.setBounds({width:t,height:n},r)},e.getSize=function(){var t=e.getBounds();return[t.width,t.height]},e.setContentSize=function(t,n,r){return e.setContentBounds({width:t,height:n},r)},e.getContentSize=function(){var t=e.getContentBounds();return[t.width,t.height]},e.setMinimumSize=function(e,n){const r=CGSizeMake(e,n);t.setContentMinSize(r)},e.getMinimumSize=function(){const e=t.contentMinSize();return[e.width,e.height]},e.setMaximumSize=function(e,n){const r=CGSizeMake(e,n);t.setContentMaxSize(r)},e.getMaximumSize=function(){const e=t.contentMaxSize();return[e.width,e.height]},e.setResizable=function(t){return e._setStyleMask(t,NSResizableWindowMask)},e.isResizable=function(){return t.styleMask()&NSResizableWindowMask},e.setMovable=function(e){return t.setMovable(e)},e.isMovable=function(){return t.isMovable()},e.setMinimizable=function(t){return e._setStyleMask(t,NSMiniaturizableWindowMask)},e.isMinimizable=function(){return t.styleMask()&NSMiniaturizableWindowMask},e.setMaximizable=function(e){t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).setEnabled(e)},e.isMaximizable=function(){return t.standardWindowButton(NSWindowZoomButton)&&t.standardWindowButton(NSWindowZoomButton).isEnabled()},e.setFullScreenable=function(t){e._setCollectionBehavior(t,NSWindowCollectionBehaviorFullScreenPrimary),e._setCollectionBehavior(!t,NSWindowCollectionBehaviorFullScreenAuxiliary)},e.isFullScreenable=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorFullScreenPrimary},e.setClosable=function(t){e._setStyleMask(t,NSClosableWindowMask)},e.isClosable=function(){return t.styleMask()&NSClosableWindowMask},e.setAlwaysOnTop=function(e,n,r){var a=NSNormalWindowLevel,o=CGWindowLevelForKey(kCGMaximumWindowLevelKey),i=CGWindowLevelForKey(kCGMinimumWindowLevelKey);e&&(a="normal"===n?NSNormalWindowLevel:"torn-off-menu"===n?NSTornOffMenuWindowLevel:"modal-panel"===n?NSModalPanelWindowLevel:"main-menu"===n?NSMainMenuWindowLevel:"status"===n?NSStatusWindowLevel:"pop-up-menu"===n?NSPopUpMenuWindowLevel:"screen-saver"===n?NSScreenSaverWindowLevel:"dock"===n?NSDockWindowLevel:NSFloatingWindowLevel);var s=a+(r||0);if(!(s>=i&&s<=o))throw new Error("relativeLevel must be between "+i+" and "+o);t.setLevel(s)},e.isAlwaysOnTop=function(){return t.level()!==NSNormalWindowLevel},e.moveTop=function(){return t.orderFrontRegardless()},e.center=function(){t.center()},e.setPosition=function(t,n,r){return e.setBounds({x:t,y:n},r)},e.getPosition=function(){var t=e.getBounds();return[t.x,t.y]},e.setTitle=function(e){t.setTitle(e)},e.getTitle=function(){return String(t.title())};var a=0;e.flashFrame=function(e){e?a=NSApp.requestUserAttention(NSInformationalRequest):(NSApp.cancelUserAttentionRequest(a),a=0)},e.getNativeWindowHandle=function(){return t},e.getNativeWebViewHandle=function(){return n},e.loadURL=function(e){if(/^(?!https?|file).*\.html?$/.test(e)&&"undefined"!=typeof __command&&__command.pluginBundle()&&(e="file://"+__command.pluginBundle().urlForResourceNamed(e).path()),/^file:\/\/.*\.html?$/.test(e))return e=(e=NSString.alloc().initWithString(e)).stringByAddingPercentEncodingWithAllowedCharacters(NSCharacterSet.URLQueryAllowedCharacterSet()),void n.loadFileURL_allowingReadAccessToURL(NSURL.URLWithString(e),NSURL.URLWithString("file:///"));const t=NSURL.URLWithString(e),r=NSURLRequest.requestWithURL(t);n.loadRequest(r)},e.reload=function(){n.reload()},e.setHasShadow=function(e){return t.setHasShadow(e)},e.hasShadow=function(){return t.hasShadow()},e.setOpacity=function(e){return t.setAlphaValue(e)},e.getOpacity=function(){return t.alphaValue()},e.setVisibleOnAllWorkspaces=function(t){return e._setCollectionBehavior(t,NSWindowCollectionBehaviorCanJoinAllSpaces)},e.isVisibleOnAllWorkspaces=function(){return t.collectionBehavior()&NSWindowCollectionBehaviorCanJoinAllSpaces},e.setIgnoreMouseEvents=function(e){return t.setIgnoresMouseEvents(e)},e.setContentProtection=function(e){t.setSharingType(e?NSWindowSharingNone:NSWindowSharingReadOnly)},e.setAutoHideCursor=function(e){t.setDisableAutoHideCursor(e)},e.setVibrancy=function(n){var r=e._vibrantView;if(!n){if(null==r)return;return r.removeFromSuperview(),void t.setVibrantView(null)}if(null==r){var a=t.contentView();r=NSVisualEffectView.alloc().initWithFrame(a.bounds()),e._vibrantView=r,r.setAutoresizingMask(NSViewWidthSizable|NSViewHeightSizable),r.setBlendingMode(NSVisualEffectBlendingModeBehindWindow),r.setState(NSVisualEffectStateActive),r.setFrame(a.bounds()),a.addSubview_positioned_relativeTo(r,NSWindowBelow,null)}var o=NSVisualEffectMaterialLight;"appearance-based"===n?o=NSVisualEffectMaterialAppearanceBased:"light"===n?o=NSVisualEffectMaterialLight:"dark"===n?o=NSVisualEffectMaterialDark:"titlebar"===n?o=NSVisualEffectMaterialTitlebar:"selection"===n?o=NSVisualEffectMaterialSelection:"menu"===n?o=NSVisualEffectMaterialMenu:"popover"===n?o=NSVisualEffectMaterialPopover:"sidebar"===n?o=NSVisualEffectMaterialSidebar:"medium-light"===n?o=NSVisualEffectMaterialMediumLight:"ultra-dark"===n&&(o=NSVisualEffectMaterialUltraDark),r.setMaterial(o)},e._setBackgroundColor=function(e){var r=function(e){if(!e||"#"!==e[0]){if(e&&"function"==typeof e.isKindOfClass&&e.isKindOfClass(NSColor))return e;throw new Error("Incorrect color formating. It should be an hex color: #RRGGBBAA")}var t,n=e.substr(1);if(3===n.length?n+="F":6===n.length&&(n+="FF"),4===n.length)for(var r=0;r<4;r+=1)t+=n[r],t+=n[r];else{if(8!==n.length)return NSColor.whiteColor();t=n}var a=parseInt(t.slice(0,2),16)/255,o=parseInt(t.slice(2,4),16)/255,i=parseInt(t.slice(4,6),16)/255,s=parseInt(t.slice(6,8),16)/255;return NSColor.colorWithSRGBRed_green_blue_alpha(a,o,i,s)}(e);n.setValue_forKey(!1,"drawsBackground"),t.backgroundColor=r},e._invalidate=function(){t.flushWindow(),t.contentView().setNeedsDisplay(!0)},e._setStyleMask=function(n,r){var a=e.isMaximizable();n?t.setStyleMask(t.styleMask()|r):t.setStyleMask(t.styleMask()&~r),e.setMaximizable(a)},e._setCollectionBehavior=function(n,r){var a=e.isMaximizable();n?t.setCollectionBehavior(t.collectionBehavior()|r):t.setCollectionBehavior(t.collectionBehavior()&~r),e.setMaximizable(a)},e._showWindowButton=function(e){var n=t.standardWindowButton(e);n.superview().addSubview_positioned_relative(n,NSWindowAbove,null)}}},function(e,t,n){var r=n(11),a=n(12);e.exports=function(e,t,n){var o=new r;o.loadURL=e.loadURL,o.loadFile=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.downloadURL=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.getURL=function(){return String(n.URL())},o.getTitle=function(){return String(n.title())},o.isDestroyed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.focus=e.focus,o.isFocused=e.isFocused,o.isLoading=function(){return!!n.loading()},o.isLoadingMainFrame=function(){return!!n.loading()},o.isWaitingForResponse=function(){return!n.loading()},o.stop=function(){n.stopLoading()},o.reload=function(){n.reload()},o.reloadIgnoringCache=function(){n.reloadFromOrigin()},o.canGoBack=function(){return!!n.canGoBack()},o.canGoForward=function(){return!!n.canGoForward()},o.canGoToOffset=function(e){return!!n.backForwardList().itemAtIndex(e)},o.clearHistory=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.goBack=function(){n.goBack()},o.goForward=function(){n.goForward()},o.goToIndex=function(e){var t=n.backForwardList(),r=t.backList(),a=r.count();if(a>e)n.loadRequest(NSURLRequest.requestWithURL(r[e]));else{var o=t.forwardList();if(!(o.count()>e-a))throw new Error("Cannot go to index "+e);n.loadRequest(NSURLRequest.requestWithURL(o[e-a]))}},o.goToOffset=function(e){if(!o.canGoToOffset(e))throw new Error("Cannot go to offset "+e);n.loadRequest(NSURLRequest.requestWithURL(n.backForwardList().itemAtIndex(e)))},o.isCrashed=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setUserAgent=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.getUserAgent=function(){const e=n.customUserAgent();return e?String(e):void 0},o.insertCSS=function(e){var t="var style = document.createElement('style'); style.innerHTML = "+e.replace(/"/,'\\"')+"; document.head.appendChild(style);",r=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);n.configuration().userContentController().addUserScript(r)},o.insertJS=function(e){var t=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(e,0,!0);n.configuration().userContentController().addUserScript(t)},o.executeJavaScript=a(n,e),o.setIgnoreMenuShortcuts=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.isAudioMuted=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setZoomFactor=function(e){n.setMagnification_centeredAtPoint(e,CGPointMake(0,0))},o.getZoomFactor=function(e){e(Number(n.magnification()))},o.setZoomLevel=function(e){o.setZoomFactor(Math.pow(1.2,e))},o.getZoomLevel=function(e){e(Math.log(Number(n.magnification()))/Math.log(1.2))},o.setVisualZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.setLayoutZoomLevelLimits=function(){console.warn("Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)")},o.send=function(){const e="window.postMessage({isSketchMessage: true,origin: '"+String(__command.identifier())+"',args: "+JSON.stringify([].slice.call(arguments))+'}, "*")';n.evaluateJavaScript_completionHandler(e,null)},o.getNativeWebview=function(){return n},e.webContents=o}},function(e,t,n){var r=n(4);e.exports={setImmediate:function(e,t,n,a,o,i,s,l,c,u,d){return r.setTimeout(e,0,t,n,a,o,i,s,l,c,u,d)},clearImmediate:function(e){return r.clearTimeout(e)}}},function(e,t){function n(e,t,n,r){n.addConstraint(NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(t,e,NSLayoutRelationEqual,n,e,1,r))}e.exports=function(e,t,r){r=r||[],e.setTranslatesAutoresizingMaskIntoConstraints(!1),n(NSLayoutAttributeLeft,e,t,r[0]||0),n(NSLayoutAttributeTop,e,t,r[1]||0),n(NSLayoutAttributeRight,e,t,r[2]||0),n(NSLayoutAttributeBottom,e,t,r[3]||0)}},function(e,t){e.exports=function(e,t){var n=e.convertPoint_fromView(t.locationInWindow(),null);return"var el = document.elementFromPoint("+n.x+", "+n.y+'); if (el && el.tagName === "SELECT") {  var event = document.createEvent("MouseEvents");  event.initMouseEvent("mousedown", true, true, window);  el.dispatchEvent(event);} else if (el && ["text", "textarea", "date", "datetime-local", "email", "number", "month", "password", "search", "tel", "time", "url", "week" ].indexOf(el.type) >= 0 && el.focus) {el.focus();} else if (el) {el.dispatchEvent(new Event("click", {bubbles: true}))}'}},function(e,t,n){var r=n(5);e.exports=function(e){var t='window.originalPostMessage = window.postMessage;window.postMessage = function(actionName) {  if (!actionName) {    throw new Error(\'missing action name\')  }  var id = String(Math.random()).replace(".", "");    var args = [].slice.call(arguments);    args.unshift(id);  return new Promise(function (resolve, reject) {    window["'+r.JS_BRIDGE_RESULT_SUCCESS+'" + id] = resolve;    window["'+r.JS_BRIDGE_RESULT_ERROR+'" + id] = reject;    window.webkit.messageHandlers.'+r.JS_BRIDGE+".postMessage(JSON.stringify(args));  });}",n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)}},function(e,t,n){(function(t,r){var a=n(5);e.exports.injectScript=function(e){var t='(function () {document.addEventListener(\'mousedown\', onMouseDown);function shouldDrag(target) {  if (!target || (target.dataset || {}).appRegion === "no-drag") { return false }  if ((target.dataset || {}).appRegion === "drag") { return true }  return shouldDrag(target.parentElement)};function onMouseDown(e) {  if (e.button !== 0 || !shouldDrag(e.target)) { return }  window.postMessage("'+a.START_MOVING_WINDOW+'");};})()',n=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(t,0,!0);e.configuration().userContentController().addUserScript(n)},e.exports.setupHandler=function(e){var n=null,o=null,i=null;function s(){if(!o||1!==NSEvent.pressedMouseButtons())return t(i),n=null,void(o=null);var r=NSEvent.mouseLocation();e.setPosition(o.x+(r.x-n.x),o.y+(n.y-r.y),!1)}e.webContents.on(a.START_MOVING_WINDOW,(function(){n=NSEvent.mouseLocation();var t=e.getPosition();o={x:t[0],y:t[1]},i=r(s,1e3/60)}))}}).call(this,n(15).clearInterval,n(15).setInterval)},function(e,t,n){(function(t,r){var a,o,i,s,l=n(31),c=n(32),u=n(5);e.exports=function(e,n,d,f){s||(s=new l({utils:null,"observeValueForKeyPath:ofObject:change:context:":function(e,t,n){const r=n[NSKeyValueChangeNewKey],a="NSAppearanceNameDarkAqua"===String(r.bestMatchFromAppearancesWithNames(["NSAppearanceNameAqua","NSAppearanceNameDarkAqua"]));this.utils.executeJavaScript("document.body.classList.remove('__skpm-"+(a?"light":"dark")+"'); document.body.classList.add('__skpm-"+(a?"dark":"light")+"')")}})),a||(a=new l({utils:null,panel:null,"windowDidResize:":function(){this.utils.emit("resize")},"windowDidMiniaturize:":function(){this.utils.emit("minimize")},"windowDidDeminiaturize:":function(){this.utils.emit("restore")},"windowDidEnterFullScreen:":function(){this.utils.emit("enter-full-screen")},"windowDidExitFullScreen:":function(){this.utils.emit("leave-full-screen")},"windowDidMove:":function(){this.utils.emit("move"),this.utils.emit("moved")},"windowShouldClose:":function(){var e=1;return this.utils.emit("close",{get defaultPrevented(){return!e},preventDefault:function(){e=0}}),e},"windowWillClose:":function(){this.utils.emit("closed")},"windowDidBecomeKey:":function(){this.utils.emit("focus",this.panel.currentEvent())},"windowDidResignKey:":function(){this.utils.emit("blur")}})),o||(o=new l({state:{wasReady:0},utils:null,"webView:didCommitNavigation:":function(e){this.utils.emit("will-navigate",{},String(String(e.URL())))},"webView:didStartProvisionalNavigation:":function(){this.utils.emit("did-start-navigation"),this.utils.emit("did-start-loading")},"webView:didReceiveServerRedirectForProvisionalNavigation:":function(){this.utils.emit("did-get-redirect-request")},"webView:didFailProvisionalNavigation:withError:":function(e,t,n){this.utils.emit("did-fail-load",n)},"webView:didFinishNavigation:":function(){0==this.state.wasReady&&(this.state.wasReady=1,this.utils.emitBrowserEvent("ready-to-show")),this.utils.emit("did-navigate"),this.utils.emit("did-frame-navigate"),this.utils.emit("did-stop-loading"),this.utils.emit("did-finish-load"),this.utils.emit("did-frame-finish-load")},"webViewWebContentProcessDidTerminate:":function(){this.utils.emit("dom-ready")}})),i||(i=new l({utils:null,"userContentController:didReceiveScriptMessage:":function(e,t){var n=this.utils.parseWebArguments(String(t.body()));n&&n[0]&&"string"==typeof n[0]&&(n[0]=String(n[0]),this.utils.emit.apply(this,n))}}));var h=s.new({utils:{executeJavaScript(e){d.evaluateJavaScript_completionHandler(e,null)}}}),g=WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly("document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-"+("undefined"!=typeof MSTheme&&MSTheme.sharedTheme().isDark()?"dark":"light")+"') }, false)",0,!0);d.configuration().userContentController().addUserScript(g),NSApplication.sharedApplication().addObserver_forKeyPath_options_context(h,"effectiveAppearance",NSKeyValueObservingOptionNew,null),NSThread.mainThread().threadDictionary()[e.id+".themeObserver"]=h;var m=o.new({utils:{setTitle:e.setTitle.bind(e),emitBrowserEvent(){try{e.emit.apply(e,arguments)}catch(e){if(void 0===t||!t.listenerCount||!t.listenerCount("uncaughtException"))throw console.error(e),e;t.emit("uncaughtException",e,"uncaughtException")}},emit(){try{e.webContents.emit.apply(e.webContents,arguments)}catch(e){if(void 0===t||!t.listenerCount||!t.listenerCount("uncaughtException"))throw console.error(e),e;t.emit("uncaughtException",e,"uncaughtException")}}},state:{wasReady:0}});d.setNavigationDelegate(m);var p=i.new({utils:{emit(t,n){if(n){for(var a=[],o=2;o<arguments.length;o+=1)a.push(arguments[o]);var i=e.webContents.listeners(n);r.all(i.map((function(e){return r.resolve().then((function(){return e.apply(e,a)}))}))).then((function(e){d.evaluateJavaScript_completionHandler(u.JS_BRIDGE_RESULT_SUCCESS+t+"("+JSON.stringify(e)+")",null)})).catch((function(e){d.evaluateJavaScript_completionHandler(u.JS_BRIDGE_RESULT_ERROR+t+"("+JSON.stringify(e)+")",null)}))}else d.evaluateJavaScript_completionHandler(u.JS_BRIDGE_RESULT_SUCCESS+t+"()",null)},parseWebArguments:c}});d.configuration().userContentController().addScriptMessageHandler_name(p,u.JS_BRIDGE);var S,y={emit(){try{e.emit.apply(e,arguments)}catch(e){if(void 0===t||!t.listenerCount||!t.listenerCount("uncaughtException"))throw console.error(e),e;t.emit("uncaughtException",e,"uncaughtException")}}};f.modal&&((S="Document"===f.parent.type?f.parent.sketchObject:f.parent)&&"MSDocumentData"===String(S.class())&&(S=S.delegate()),y.parentWindow=S.windowForSheet());var v=a.new({utils:y,panel:n});n.setDelegate(v)}}).call(this,n(30),n(13))},function(e,t,n){(function(t,n){var r,a,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===t)return t(e,0);if((r===i||!r)&&t)return r=t,t(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof t?t:i}catch(e){r=i}try{a="function"==typeof n?n:s}catch(e){a=s}}();var c,u=[],d=!1,f=-1;function h(){d&&c&&(d=!1,c.length?u=c.concat(u):f=-1,u.length&&g())}function g(){if(!d){var e=l(h);d=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,d=!1,function(e){if(a===n)return n(e);if((a===s||!a)&&n)return a=n,n(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function p(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||d||l(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}).call(this,n(4).setTimeout,n(4).clearTimeout)},function(module,exports){module.exports=function MochaDelegate(definition,superclass){var uniqueClassName="MochaJSDelegate_DynamicClass_"+NSUUID.UUID().UUIDString(),delegateClassDesc=MOClassDescription.allocateDescriptionForClassWithName_superclass_(uniqueClassName,superclass||NSObject),handlers={},ivars={};function setHandlerForSelector(selectorString,func){var handlerHasBeenSet=selectorString in handlers,selector=NSSelectorFromString(selectorString);if(handlers[selectorString]=func,!handlerHasBeenSet){for(var args=[],regex=/:/g;regex.exec(selectorString);)args.push("arg"+args.length);var dynamicFunction=eval("(function ("+args.join(", ")+") { return handlers[selectorString].apply(this, arguments); })");delegateClassDesc.addInstanceMethodWithSelector_function(selector,dynamicFunction)}}function setIvar(e,t){var n=e in handlers;if(ivars[e]=t,!n){delegateClassDesc.addInstanceVariableWithName_typeEncoding(e,"@");var r=MOPropertyDescription.new();r.name=e,r.typeEncoding="@",r.weak=!0,r.ivarName=e,delegateClassDesc.addProperty(r)}}this.getClass=function(){return NSClassFromString(uniqueClassName)},this.getClassInstance=function(e){var t=NSClassFromString(uniqueClassName).new();return Object.keys(ivars).forEach((function(e){t[e]=ivars[e]})),Object.keys(e||{}).forEach((function(n){t[n]=e[n]})),t},this.new=this.getClassInstance,"object"==typeof definition&&Object.keys(definition).forEach((function(e){"function"==typeof definition[e]?setHandlerForSelector(e,definition[e]):setIvar(e,definition[e])})),delegateClassDesc.registerClass()}},function(e,t){e.exports=function(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t&&t.constructor&&t.constructor===Array&&0!=t.length?t:null}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),a=0;for(t=0;t<n;t++)for(var o=arguments[t],i=0,s=o.length;i<s;i++,a++)r[a]=o[i];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAltTextItem=t.editAltTextItem=t.addAltTextItem=t.getAltTextArtboards=t.getAltTextArtboardGroupIds=t.handleDeleteAltTextItem=t.handleAddAltTextItem=t.handleAltTextLoaded=void 0;var a=n(1),o=n(3),i=n(6),s=n(2).Group,l=n(2).ShapePath,c=n(2).Style,u=n(2).Rectangle,d=n(2).Text,f=[];t.handleAltTextLoaded=function(){var e=a.getBrowserWindow();try{var t=h();if(t&&t.length>0){var n=g(t);f=n}e.webContents.executeJavaScript("altTextLoaded('"+JSON.stringify(f)+"')").catch(console.error)}catch(e){a.debug(e)}},t.handleAddAltTextItem=function(e){var t=a.getBrowserWindow();try{var n,o=JSON.parse(e),i=r(f);if(o.layerId&&i.forEach((function(e){n=e.altTexts.find((function(e){return e.layerId===o.layerId}))})),n)n.text=o.text,n.status=o.status,p(n.layerId,n.text,n.status);else{var s=m(o.status,o.text);if(s&&s.artboardId){var l=f.find((function(e){return e.artboardId===s.artboardId}));l?l.altTexts.push({name:s.name,status:s.status,text:s.text,layerId:s.layerId,layerName:s.layerName}):f.push({artboardId:s.artboardId,artboardName:s.artboardName,altTexts:[{name:s.name,status:s.status,text:s.text,layerId:s.layerId,layerName:s.layerName}]})}}t.webContents.executeJavaScript("altTextLoaded('"+JSON.stringify(f)+"')").catch(console.error)}catch(e){a.debug(e)}},t.handleDeleteAltTextItem=function(e){var t=a.getBrowserWindow(),n=JSON.parse(e).layerId;S(n),f.forEach((function(e){var t=e.altTexts.findIndex((function(e){return e.layerId===n}));t>-1&&e.altTexts.splice(t,1)}));var r=f.findIndex((function(e){return e.altTexts.length<1}));r>-1&&f.splice(r,1),t.webContents.executeJavaScript("altTextLoaded('"+JSON.stringify(f)+"')").catch(console.error)};var h=function(){var e=o.getSelectedDocument();return i.documentSettingForKey(e,"stark-alt-text-artboards")||[]};t.getAltTextArtboardGroupIds=h;var g=function(e){var t=o.getSelectedDocument(),n=[],r=[];return e.forEach((function(e,a){var o=t.getLayerWithID(e);if(o){var s=i.layerSettingForKey(o,"stark-alt-text-main-group");if(s){var l=t.getLayerWithID(s);if(l){var c=l.getParentArtboard(),u={artboardName:c.name,artboardId:c.id,altTexts:[]},d=[];l.layers.forEach((function(e,t){var n=i.layerSettingForKey(e,"stark-alt-text-item");n&&d.push({layerId:n.layerId,name:n.name,status:n.status,text:n.text})})),d.reverse(),u.altTexts=d,n.push(u)}else r.push(a)}}})),r.forEach((function(t){e.splice(t,1)})),i.setDocumentSettingForKey(t,"stark-alt-text-artboards",e),n};t.getAltTextArtboards=g;var m=function(e,t){var n,r=o.getSelectedDocument(),s=r.selectedLayers;if(s.isEmpty)a.showToast("Please select a layer to attach alt-text to.");else if(s.length>1)a.showToast("Alt-text can only be attached to one layer or group.");else{var l,c=s.layers[0].getParentArtboard(),u=i.layerSettingForKey(c,"stark-alt-text-main-group"),d=r.getLayerWithID(u);if(d)l=v(d.layers.length+1,e,t,s.layers[0],d);else{d=y(c),l=v(1,e,t,s.layers[0],d),i.setLayerSettingForKey(c,"stark-alt-text-main-group",d.id);var f=i.documentSettingForKey(r,"stark-alt-text-artboards");f||(f=[]),f.push(c.id),i.setDocumentSettingForKey(r,"stark-alt-text-artboards",f)}l.moveToBack(),i.setLayerSettingForKey(l,"stark-alt-text-item",{layerId:l.id,name:s.layers[0].name,status:e,text:t}),n={artboardId:c.id,artboardName:c.name,layerId:l.id,layerName:s.layers[0].name,name:s.layers[0].name,status:e,text:t}}return n};t.addAltTextItem=m;var p=function(e,t,n){var r=o.getSelectedDocument().getLayerWithID(e);if(r){var a=r.layers[2],u=r.layers[1],f=r.layers[0];u.layers[1].remove();var h=u.layers[0],g=new s({name:"right",parent:u}),m=new l({frame:{x:h.frame.width,y:12,width:27,height:20},type:o.Types.ShapePath,name:"status background",shapeType:l.ShapeType.Rectangle,style:{fills:[],borders:[{color:"#0000001a",fillType:c.FillType.Color,thickness:1,position:c.BorderPosition.Inside}]},parent:g});m.points[1].cornerRadius=5,m.points[2].cornerRadius=5;var p;p="written"===n||"decorative"===n?'<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.89355 9.94531C4.21045 9.94531 4.45752 9.82178 4.62939 9.56396L9.65674 1.78662C9.78564 1.59326 9.83398 1.42139 9.83398 1.25488C9.83398 0.830566 9.52246 0.524414 9.0874 0.524414C8.78662 0.524414 8.604 0.631836 8.42139 0.921875L3.87207 8.12988L1.54102 5.17578C1.36377 4.95557 1.18115 4.85889 0.917969 4.85889C0.477539 4.85889 0.160645 5.17041 0.160645 5.6001C0.160645 5.78809 0.225098 5.96533 0.380859 6.15332L3.16309 9.58008C3.36719 9.83252 3.59277 9.94531 3.89355 9.94531Z" fill="#381FD1" /></svg>':"to-do"===n?'<svg width="10" height="2" viewBox="0 0 10 2" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.14355 1.82031H8.85107C9.21631 1.82031 9.5332 1.50879 9.5332 1.12744C9.5332 0.751465 9.21631 0.43457 8.85107 0.43457H1.14355C0.789062 0.43457 0.461426 0.751465 0.461426 1.12744C0.461426 1.50879 0.789062 1.82031 1.14355 1.82031Z" fill="rgba(0,0,0,0.95)" /></svg>':'<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.88037 11.332H10.125C11.0811 11.332 11.7041 10.6123 11.7041 9.74756C11.7041 9.48438 11.6343 9.21582 11.4946 8.96875L7.36426 1.76074C7.05811 1.23438 6.53711 0.96582 6 0.96582C5.46289 0.96582 4.93652 1.23975 4.63574 1.76074L0.505371 8.97412C0.365723 9.22119 0.295898 9.48438 0.295898 9.74756C0.295898 10.6123 0.918945 11.332 1.88037 11.332ZM2.03613 10.188C1.72998 10.188 1.52588 9.94092 1.52588 9.66162C1.52588 9.58105 1.53662 9.48438 1.58496 9.39844L5.5542 2.43213C5.65088 2.26562 5.82812 2.19043 6 2.19043C6.17188 2.19043 6.34375 2.26562 6.44043 2.4375L10.4097 9.40381C10.458 9.48975 10.4795 9.58643 10.4795 9.66162C10.4795 9.94092 10.2646 10.188 9.96387 10.188H2.03613ZM6.00537 7.54541C6.31689 7.54541 6.50488 7.36816 6.51562 7.03516L6.59619 4.59668C6.6123 4.25293 6.35449 4.01123 6 4.01123C5.63477 4.01123 5.3877 4.25293 5.40381 4.59131L5.479 7.04053C5.49512 7.36816 5.67773 7.54541 6.00537 7.54541ZM6.00537 9.3501C6.37061 9.3501 6.66602 9.09766 6.66602 8.73779C6.66602 8.37793 6.37598 8.12549 6.00537 8.12549C5.62939 8.12549 5.33398 8.3833 5.33398 8.73779C5.33398 9.09766 5.63477 9.3501 6.00537 9.3501Z" fill="#BA1C1C" /></svg>';var S=o.createLayerFromData(p,"svg");S.parent=g,S.frame.x=h.frame.x+h.frame.width+5,S.frame.y=h.frame.y+S.frame.height/2;var y=new d({type:o.Types.Text,name:"status",text:""+(n.charAt(0).toUpperCase()+n.slice(1)),style:{fontFamily:"Helvetica",textColor:"written"===n||"decorative"===n||"to-do"===n?"#000000f2":"#BA1C1C",fontSize:13,fontStyle:"normal",lineHeight:20,kerning:-.08,borders:[]},parent:g});y.fixedWidth=!1,m.frame.width=S.frame.width+y.frame.width+19,m.frame.height=20,m.frame.x=h.frame.x+h.frame.width-1,m.frame.y=h.frame.y,y.frame.x=S.frame.x+S.frame.width+5,y.frame.y=m.frame.y,g.adjustToFit(),u.adjustToFit(),a.layers[0].text=""+t,a.adjustToFit(),r.adjustToFit(),f.frame.height!==r.frame.height&&(f.frame.height=r.frame.height+12),r.adjustToFit();var v=i.layerSettingForKey(r,"stark-alt-text-item");i.setLayerSettingForKey(r,"stark-alt-text-item",{layerId:v.layerId,name:v.name,status:n,text:t})}};t.editAltTextItem=p;var S=function(e){var t=o.getSelectedDocument(),n=t.getLayerWithID(e),r=n.parent,a=r.layers.length;if(1===a){var s=i.documentSettingForKey(t,"stark-alt-text-artboards"),l=s.findIndex((function(e){return e===r.id}));s.splice(l,1),i.setDocumentSettingForKey(t,"stark-alt-text-artboards",s)}n.remove(),1===a&&r.remove()};t.deleteAltTextItem=S;var y=function(e){return new s({name:"Stark Alt-Texts",parent:e})},v=function(e,t,n,r,a){var i=new s({name:""+r.name,parent:a,frame:new u(0,0,260,100)}),f=new l({frame:{x:r.frame.x-12,y:r.frame.y-12,width:260,height:20},type:o.Types.ShapePath,name:"Background",shapeType:l.ShapeType.Rectangle,style:{fills:[{color:"#FFFFFF",fillType:c.FillType.Color}],borders:[{color:"##0000001a",fillType:c.FillType.Color,thickness:.5,position:c.BorderPosition.Inside}],shadows:[{color:"#00000040",blur:4,x:0,y:1,spread:0}]},parent:i});f.points.forEach((function(e){return e.cornerRadius=4}));var h=new s({name:"badges",parent:i}),g=new s({name:"left",parent:h}),m=new l({frame:{x:f.frame.x+12,y:f.frame.y+12,width:27,height:20},type:o.Types.ShapePath,name:"index background",shapeType:l.ShapeType.Rectangle,style:{fills:[{color:"#381FD1",fillType:c.FillType.Color}],borders:[]},parent:g});m.points[0].cornerRadius=5,m.points[3].cornerRadius=5;var p=new d({type:o.Types.Text,name:"index",text:"#"+e,style:{fontFamily:"Helvetica",textColor:"#FFFFFF",fontSize:13,fontStyle:"normal",lineHeight:20,kerning:-.08,borders:[]},parent:g});p.fixedWidth=!1,m.frame.width=p.frame.width+8,m.frame.height=20,p.frame.x=m.frame.x+4,p.frame.y=m.frame.y,g.adjustToFit();var S,y=new s({name:"right",parent:h}),v=new l({frame:{x:m.frame.width,y:12,width:27,height:20},type:o.Types.ShapePath,name:"status background",shapeType:l.ShapeType.Rectangle,style:{fills:[],borders:[{color:"#0000001a",fillType:c.FillType.Color,thickness:1,position:c.BorderPosition.Inside}]},parent:y});v.points[1].cornerRadius=5,v.points[2].cornerRadius=5,S="written"===t||"decorative"===t?'<svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.89355 9.94531C4.21045 9.94531 4.45752 9.82178 4.62939 9.56396L9.65674 1.78662C9.78564 1.59326 9.83398 1.42139 9.83398 1.25488C9.83398 0.830566 9.52246 0.524414 9.0874 0.524414C8.78662 0.524414 8.604 0.631836 8.42139 0.921875L3.87207 8.12988L1.54102 5.17578C1.36377 4.95557 1.18115 4.85889 0.917969 4.85889C0.477539 4.85889 0.160645 5.17041 0.160645 5.6001C0.160645 5.78809 0.225098 5.96533 0.380859 6.15332L3.16309 9.58008C3.36719 9.83252 3.59277 9.94531 3.89355 9.94531Z" fill="#381FD1" /></svg>':"to-do"===t?'<svg width="10" height="2" viewBox="0 0 10 2" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.14355 1.82031H8.85107C9.21631 1.82031 9.5332 1.50879 9.5332 1.12744C9.5332 0.751465 9.21631 0.43457 8.85107 0.43457H1.14355C0.789062 0.43457 0.461426 0.751465 0.461426 1.12744C0.461426 1.50879 0.789062 1.82031 1.14355 1.82031Z" fill="rgba(0,0,0,0.95)" /></svg>':'<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.88037 11.332H10.125C11.0811 11.332 11.7041 10.6123 11.7041 9.74756C11.7041 9.48438 11.6343 9.21582 11.4946 8.96875L7.36426 1.76074C7.05811 1.23438 6.53711 0.96582 6 0.96582C5.46289 0.96582 4.93652 1.23975 4.63574 1.76074L0.505371 8.97412C0.365723 9.22119 0.295898 9.48438 0.295898 9.74756C0.295898 10.6123 0.918945 11.332 1.88037 11.332ZM2.03613 10.188C1.72998 10.188 1.52588 9.94092 1.52588 9.66162C1.52588 9.58105 1.53662 9.48438 1.58496 9.39844L5.5542 2.43213C5.65088 2.26562 5.82812 2.19043 6 2.19043C6.17188 2.19043 6.34375 2.26562 6.44043 2.4375L10.4097 9.40381C10.458 9.48975 10.4795 9.58643 10.4795 9.66162C10.4795 9.94092 10.2646 10.188 9.96387 10.188H2.03613ZM6.00537 7.54541C6.31689 7.54541 6.50488 7.36816 6.51562 7.03516L6.59619 4.59668C6.6123 4.25293 6.35449 4.01123 6 4.01123C5.63477 4.01123 5.3877 4.25293 5.40381 4.59131L5.479 7.04053C5.49512 7.36816 5.67773 7.54541 6.00537 7.54541ZM6.00537 9.3501C6.37061 9.3501 6.66602 9.09766 6.66602 8.73779C6.66602 8.37793 6.37598 8.12549 6.00537 8.12549C5.62939 8.12549 5.33398 8.3833 5.33398 8.73779C5.33398 9.09766 5.63477 9.3501 6.00537 9.3501Z" fill="#BA1C1C" /></svg>';var T=o.createLayerFromData(S,"svg");T.parent=y,T.frame.x=g.frame.x+g.frame.width+5,T.frame.y=g.frame.y+T.frame.height/2;var w=new d({type:o.Types.Text,name:"status",text:""+(t.charAt(0).toUpperCase()+t.slice(1)),style:{fontFamily:"Helvetica",textColor:"written"===t||"decorative"===t||"to-do"===t?"#000000f2":"#BA1C1C",fontSize:13,fontStyle:"normal",lineHeight:20,kerning:-.08,borders:[]},parent:y});w.fixedWidth=!1,v.frame.width=T.frame.width+w.frame.width+19,v.frame.height=20,v.frame.x=g.frame.x+g.frame.width-1,v.frame.y=g.frame.y,w.frame.x=T.frame.x+T.frame.width+5,w.frame.y=v.frame.y,y.adjustToFit(),h.adjustToFit();var C=new s({name:"alt-text",parent:i}),N=new d({type:o.Types.Text,name:"alt-text",text:""+n,style:{fontFamily:"Helvetica",textColor:"#000000f2",fontSize:13,fontStyle:"normal",kerning:-.08,lineHeight:20,borders:[],alignment:d.Alignment.left},parent:C});N.frame.width=234,N.fixedWidth=!0,N.frame.x=f.frame.x+12,N.frame.y=f.frame.y+40,C.adjustToFit(),i.adjustToFit(),f.frame.height=i.frame.height+12;var L=new u(0,0,100,100).changeBasis({from:r,to:r.getParentArtboard()});return b(i,L.x-12,L.y-12),i.adjustToFit(),i},b=function(e,t,n){var r=function(e){for(var t={x:0,y:0},n=e.parent;n.name&&"Artboard"!==n.type;)t.x+=n.frame.x,t.y+=n.frame.y,n=n.parent;return t}(e),a=new o.Rectangle(e.frame);a.x=t-r.x,a.y=n-r.y,e.frame=a,T(e)},T=function(e){for(var t=e.parent;t&&t.name&&"Artboard"!==t.type;)t.adjustToFit(),t=t.parent}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getChildLayers=t.isLayerGroup=t.debug=t.convertDefaultTool=t.showToast=t.updateSubscription=t.clearAllSettings=t.generateMixpanelUniqueId=t.loadAllSettings=t.loadSetting=t.saveAllSettings=t.saveSetting=t.openURL=t.setWindowBounds=t.getBrowserWindow=void 0;var r=n(35),a=n(16),o=n(6),i=n(36);t.getBrowserWindow=function(){return r.getWebview("stark.main")},t.setWindowBounds=function(e,n){var r=t.getBrowserWindow(),a=r.getBounds();a.height>n?r.setBounds({y:a.y-(a.height-n),height:n,width:e}):a.height<n?r.setBounds({y:a.y+(n-a.height),height:n,width:e}):r.setBounds({height:n,width:e})},t.openURL=function(e){var t=NSURL.URLWithString(e);NSWorkspace.sharedWorkspace().openURL(t)},t.saveSetting=function(e,t){o.setSettingForKey("com.stark."+e,t)},t.saveAllSettings=function(e){t.saveSetting(a.SETTINGS_USERID,e.id),t.saveSetting(a.SETTINGS_EMAIL,e.email),t.saveSetting(a.SETTINGS_MIXPANELID,e.mp_id),t.saveSetting(a.SETTINGS_OPTINUSAGEDATA,e.optInUsageData),t.saveSetting(a.SETTINGS_STATUS,e.status),t.saveSetting(a.SETTINGS_PLAN,e.plan),t.saveSetting(a.SETTINGS_TEAMUSER,e.teamUser),t.saveSetting(a.SETTINGS_TEAMPLANSTATUS,e.teamPlanStatus)},t.loadSetting=function(e){return o.settingForKey("com.stark."+e)},t.loadAllSettings=function(){var e;return void 0!==t.loadSetting(a.SETTINGS_MIXPANELID)&&""!==t.loadSetting(a.SETTINGS_MIXPANELID)||(e=t.generateMixpanelUniqueId(),t.saveSetting(a.SETTINGS_MIXPANELID,e),t.saveSetting(a.SETTINGS_OPTINUSAGEDATA,!0)),{id:t.loadSetting(a.SETTINGS_USERID),email:t.loadSetting(a.SETTINGS_EMAIL),mp_id:t.loadSetting(a.SETTINGS_MIXPANELID),optInUsageData:t.loadSetting(a.SETTINGS_OPTINUSAGEDATA),status:t.loadSetting(a.SETTINGS_STATUS),plan:void 0===t.loadSetting(a.SETTINGS_PLAN)||""===t.loadSetting(a.SETTINGS_PLAN)?"":t.loadSetting(a.SETTINGS_PLAN),teamUser:t.loadSetting(a.SETTINGS_TEAMUSER),teamPlanStatus:t.loadSetting(a.SETTINGS_TEAMPLANSTATUS),contrastFailMessageShown:void 0===t.loadSetting(a.SETTINGS_CONTRASTFAILMESSAGESHOWN)||""===t.loadSetting(a.SETTINGS_CONTRASTFAILMESSAGESHOWN)||t.loadSetting(a.SETTINGS_CONTRASTFAILMESSAGESHOWN),suggestionsTriesLeft:void 0===t.loadSetting(a.SETTINGS_CONTRASTSUGGESTIONSTRIESLEFT)||""===t.loadSetting(a.SETTINGS_CONTRASTSUGGESTIONSTRIESLEFT)?4:t.loadSetting(a.SETTINGS_CONTRASTSUGGESTIONSTRIESLEFT),generatorTriesLeft:void 0===t.loadSetting(a.SETTINGS_GENERATORTRIESLEFT)||""===t.loadSetting(a.SETTINGS_GENERATORTRIESLEFT)?3:t.loadSetting(a.SETTINGS_GENERATORTRIESLEFT)}},t.generateMixpanelUniqueId=function(){return((new Date).getUTCMilliseconds().toString()+(new Date).getTime().toString()).toString()},t.clearAllSettings=function(){[a.SETTINGS_USERID,a.SETTINGS_STATUS,a.SETTINGS_EMAIL,a.SETTINGS_PLAN,a.SETTINGS_MIXPANELID,a.SETTINGS_OPTINUSAGEDATA,a.SETTINGS_TEAMUSER,a.SETTINGS_TEAMPLANSTATUS].forEach((function(e){t.saveSetting(e,"")}))},t.updateSubscription=function(e){t.saveSetting(a.SETTINGS_USERID,e.id),t.saveSetting(a.SETTINGS_EMAIL,e.email),t.saveSetting(a.SETTINGS_STATUS,e.status),t.saveSetting(a.SETTINGS_PLAN,e.plan),t.saveSetting(a.SETTINGS_TEAMUSER,e.teamUser),t.saveSetting(a.SETTINGS_TEAMPLANSTATUS,e.teamPlanStatus),t.saveSetting(a.SETTINGS_OPTINUSAGEDATA,e.optInUsageData)},t.showToast=function(e){i.message(e)},t.convertDefaultTool=function(e){var t="";switch(e){case"Main":t="Main";break;case"Contrast":t="Check Contrast";break;case"Typography":t="Typography";break;case"Alt-Text":t="Alt-Text";break;case"Touch Targets":t="Touch Targets";break;case"Focus Order":t="Focus Order";break;case"Landmarks":t="Landmarks";break;case"Vision":t="Vision Simulator";break;default:t="Main"}return t},t.debug=function(e){console.log("======================="),console.log("======================="),console.log("======================="),console.log("======================="),console.log(e),console.log("======================="),console.log("======================="),console.log("======================="),console.log("=======================")},t.isLayerGroup=function(e){return"Page"===e.type||"Group"===e.type||"SymbolInstance"===e.type||"SymbolMaster"===e.type||"Artboard"===e.type};var s=function(e){return"SymbolInstance"===e.type};t.getChildLayers=function(e,n){var r=[],a=function(e){if(e){var o=e.name;if("Stark Landmarks"!==o&&"Stark Alt-Texts"!==o&&"Stark Focus Orders"!==o)if(t.isLayerGroup(e)&&!s(e))e.layers.forEach((function(e){t.isLayerGroup(e)?a(e):r.push(e)}));else if(s(e)&&n){var i=e.detach({recursively:!0});a(i)}else s(e)&&(i=e.master,a(i))}};return a(e),r}},function(e,t,n){var r=NSThread.mainThread().threadDictionary();e.exports.getWebview=function(e){return n(10).fromId(e)},e.exports.isWebviewPresent=function(e){return!!r[e]},e.exports.sendToWebview=function(t,n){if(e.exports.isWebviewPresent(t)){for(var a=null,o=r[t].contentView().subviews(),i=0;i<o.length;i+=1)a||o[i].isKindOfClass(WKInspectorWKWebView)||!o[i].isKindOfClass(WKWebView)||(a=o[i]);if(!a||!a.evaluateJavaScript_completionHandler)throw new Error("Webview "+t+" not found");a.evaluateJavaScript_completionHandler(n,null)}}},function(e,t){e.exports=require("sketch/ui")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MixColors=void 0,t.MixColors=function(e,t){for(var n=[e.r,e.g,e.b],r=[t.r,t.g,t.b],a=[],o=0;o<=2;o++){var i=r[o],s=n[o];a.push(s+(i-s)*(t.a||1))}return{r:Math.round(a[0]),g:Math.round(a[1]),b:Math.round(a[2]),a:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetLuminance=void 0,t.GetLuminance=function(e){var t,n,r,a,o,i;return t=e.r/255,n=e.g/255,r=e.b/255,a=t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4),o=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),i=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4),Number((.2126*a+.7152*o+.0722*i).toFixed(2))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetColorSuggestions=t.GetNearestPassingColor=t.DetermineColorModification=void 0;var r=n(17),a=n(20),o=n(9);t.DetermineColorModification=function(e,t,n){void 0===n&&(n=.05);var o=(0,r.LightenColor)(e,n),i=(0,r.DarkenColor)(e,n);return(0,a.GetContrastRatio)(o,t)>(0,a.GetContrastRatio)(i,t)?"light":"dark"},t.GetNearestPassingColor=function(e,n,o,i,s){var l;void 0===o&&(o=.05),void 0===i&&(i=4.5);var c=(0,t.DetermineColorModification)(e,n,o);l=s?"light"===s?r.LightenColor:r.DarkenColor:"light"===c?r.LightenColor:r.DarkenColor;for(var u=o,d=(0,a.GetContrastRatio)(e,n),f=d<i,h=e;f;){var g=l(e,u+=o),m=d;(d=(0,a.GetContrastRatio)(g,n))>=i&&(h=g,f=!1),m===d&&(f=!1,d<i&&(h=(0,t.GetNearestPassingColor)(e,n,o,i,l===r.LightenColor?"dark":"light")))}return h},t.GetColorSuggestions=function(e,n,a,i,s){void 0===a&&(a=4),void 0===i&&(i=.05),void 0===s&&(s=.1);for(var l=(0,t.DetermineColorModification)(e,n,i),c=(0,t.GetNearestPassingColor)(e,n,i),u="light"===l?r.LightenColor:r.DarkenColor,d=[(0,o.ConvertRgbaToRgbaString)(c)],f=1;f<a;f++)d.push((0,o.ConvertRgbaToRgbaString)(u(c,f*s)));var h=0;if(d.forEach((function(e,t){0!==t&&e===d[t-1]&&h++})),h>2){var g="light"===l?r.DarkenColor:r.LightenColor,m=(0,t.GetNearestPassingColor)(e,n,i,4.5,"light"===l?"dark":"light"),p=[(0,o.ConvertRgbaToRgbaString)(m)];for(f=1;f<a;f++)p.push((0,o.ConvertRgbaToRgbaString)(g(m,.1*f)));var S=0;if(p.forEach((function(e,t){0!==t&&e===p[t-1]&&S++})),S<h)return p}return d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertHexToRgba=t.ConvertHexToRgbaString=void 0,t.ConvertHexToRgbaString=function(e){var t=e.startsWith("#")?e.substring(1,e.length+1):e,n={r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:parseInt(t.slice(6,8),16)/255};return"rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(n.a?n.a.toFixed(2):1,")")},t.ConvertHexToRgba=function(e){var t=e.startsWith("#")?e.substring(1,e.length+1):e,n=parseInt(t.slice(6,8),16)/255||1;return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:Number(n.toFixed(2))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetColorblindMatrixString=t.GetColorblindMatrixArray=t.SimulateColorblindness=void 0,t.SimulateColorblindness=function(e,t){var n=function(e){return e<0?0:e<255?e:255},r=e.r,a=e.g,o=e.b,i=e.a?e.a:1,s=r*t[0]+a*t[1]+o*t[2]+i*t[3]+t[4],l=r*t[5]+a*t[6]+o*t[7]+i*t[8]+t[9],c=r*t[10]+a*t[11]+o*t[12]+i*t[13]+t[14],u=r*t[15]+a*t[16]+o*t[17]+i*t[18]+t[19];return{r:Math.round(n(s)),g:Math.round(n(l)),b:Math.round(n(c)),a:n(u)}},t.GetColorblindMatrixArray=function(e){switch(e){case"Protanopia":return[.152,1.053,-.205,0,0,.115,.786,.099,0,0,-.004,-.048,1.052,0,0,0,0,0,1,0];case"Protanomaly":return[.817,.183,0,0,0,.333,.667,0,0,0,0,.125,.875,0,0,0,0,0,1,0];case"Deuteranopia":return[.367,.861,-.228,0,0,.28,.673,.047,0,0,-.012,.043,.969,0,0,0,0,0,1,0];case"Deuteranomaly":return[.8,.2,0,0,0,.258,.742,0,0,0,0,.142,.858,0,0,0,0,0,1,0];case"Tritanopia":return[1.256,-.077,-.179,0,0,-.078,.931,.148,0,0,.005,.691,.304,0,0,0,0,0,1,0];case"Tritanomaly":return[.967,.033,0,0,0,0,.733,.267,0,0,0,.183,.817,0,0,0,0,0,1,0];case"Achromatopsia":return[.213,.715,.072,0,0,.213,.715,.072,0,0,.213,.715,.072,0,0,0,0,0,1,0];case"Achromatomaly":return[.618,.32,.062,0,0,.163,.775,.062,0,0,.163,.32,.516,0,0,0,0,0,1,0];default:return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}},t.GetColorblindMatrixString=function(e){return(0,t.GetColorblindMatrixArray)(e).join(", ")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleMoveFocusItem=t.handleSaveNameFocusItem=t.handleDeleteFocusItem=t.handleAddFocusItem=t.handleDeleteSequence=t.handleSaveNameSequence=t.handleMoveSequence=t.handleSelectSequence=t.handleCreateSequence=t.handleFocusOrderLoaded=void 0;var r=n(1),a=n(3),o=n(6),i=n(2).Group,s=n(2).Style,l=n(2).ShapePath,c=n(2).Rectangle,u=n(2).Text,d=[],f=null,h=[];t.handleFocusOrderLoaded=function(){var e=r.getBrowserWindow(),t=g();if(t&&t.length>0){var n=m(t);d=n;var a={sequences:n};e.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(a)+"')").catch(console.error)}},t.handleCreateSequence=function(e){try{var t=r.getBrowserWindow(),n=JSON.parse(e);if(d.find((function(e){return e.name===n.name})))r.showToast("Sequence names must be unique.");else{f={id:n.name,name:n.name},d.push(f);var a={sequences:d,focusItems:h=[]};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(a)+"')").catch(console.error)}}catch(e){r.debug(e)}},t.handleSelectSequence=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=d[n.index].id,o=p(a);f={id:a,name:n.name};var i={focusItems:h=o};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(i)+"')").catch(console.error)},t.handleMoveSequence=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=d[n.startingIndex].id,o=d[n.destinationIndex].id;S(a,o,n.startingIndex,n.destinationIndex);var i=d[n.startingIndex];d.splice(n.startingIndex,1),d.splice(n.destinationIndex,0,i);var s={sequences:d};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(s)+"')").catch(console.error)},t.handleSaveNameSequence=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e);if(d.find((function(e){return e.name===n.name})))r.showToast("Sequence names must be unique.");else{var a=d[n.index].id;y(a,n.name),d[n.index].name=n.name;var o={sequences:d};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(o)+"')").catch(console.error)}},t.handleDeleteSequence=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=d[n.index].id;v(a,n.index),f.id===a&&(h=[]),d.splice(n.index,1);var o={sequences:d};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(o)+"')").catch(console.error)},t.handleAddFocusItem=function(){var e=r.getBrowserWindow(),t=b(h.length,f);t.sequenceId&&(d.find((function(e){return e.name===f.name})).id=t.sequenceId),h.push({id:t.id,name:t.name});var n={sequences:d,focusItems:h};e.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(n)+"')").catch(console.error)},t.handleDeleteFocusItem=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=h[n.index].id;_(a),h.splice(n.index,1);var o={focusItems:h};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(o)+"')").catch(console.error)},t.handleSaveNameFocusItem=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=h[n.index].id;E(n.index,n.name,a),h[n.index].name=n.name;var o={focusItems:h};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(o)+"')").catch(console.error)},t.handleMoveFocusItem=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=h[n.startingIndex].id,o=h[n.destinationIndex].id;x(a,o);var i=h[n.startingIndex];h.splice(n.startingIndex,1),h.splice(n.destinationIndex,0,i);var s={focusItems:h};t.webContents.executeJavaScript("focusOrderLoaded('"+JSON.stringify(s)+"')").catch(console.error)};var g=function(){var e=a.getSelectedDocument();return o.documentSettingForKey(e,"stark-fo-main-groups")||[]},m=function(e){var t=a.getSelectedDocument(),n=[],r=[];return e.forEach((function(e,a){var i=t.getLayerWithID(e);if(i){var s=o.layerSettingForKey(i,"stark-fo-sequences"),l=[];s&&(s.forEach((function(e,r){e&&t.getLayerWithID(e.id)?n.push({id:e.id,name:e.name}):l.push(r)})),l.forEach((function(e){s.splice(e,1)})),o.setLayerSettingForKey(i,"stark-fo-sequences",s))}else r.push(a)})),r.forEach((function(t){e.splice(t,1)})),o.setDocumentSettingForKey(t,"stark-fo-main-groups",e),n},p=function(e){var t=a.getSelectedDocument(),n=t.getLayerWithID(e),r=[];return n.layers.forEach((function(e,a){var i=o.layerSettingForKey(e,"stark-fo-item"),s=t.getLayerWithID(i.id),l=s.layers[s.layers.length-1];l.text!=n.layers.length-a&&(s.name=n.layers.length-a+" - "+i.name,l.text=""+(n.layers.length-a)),i&&r.push({associatedId:i.associatedId,id:i.id,name:i.name})})),r.reverse(),r},S=function(e,t,n,r){var i=a.getSelectedDocument(),s=i.getLayerWithID(e),l=i.getLayerWithID(t);if(s&&l){s.index=l.index;var c=i.getLayerWithID(s.parent.id);if(c){var u=o.layerSettingForKey(c,"stark-fo-sequences"),d=u[n];u.splice(n,1),u.splice(r,0,d),o.setLayerSettingForKey(c,"stark-fo-sequences",u)}}},y=function(e,t){var n=a.getSelectedDocument(),r=n.getLayerWithID(e),i=r.getParentArtboard(),s=o.layerSettingForKey(i,"stark-fo-main-group"),l=n.getLayerWithID(s),c=o.layerSettingForKey(l,"stark-fo-sequences"),u=c.find((function(t){return t.id===e}));u&&(u.name=t,r.name=t,o.setLayerSettingForKey(l,"stark-fo-sequences",c))},v=function(e,t){var n=a.getSelectedDocument(),r=n.getLayerWithID(e),i=r.getParentArtboard(),s=o.layerSettingForKey(i,"stark-fo-main-group"),l=n.getLayerWithID(s),c=o.layerSettingForKey(l,"stark-fo-sequences");c.splice(t,1),r.remove(),c&&c.length>0&&o.setLayerSettingForKey(l,"stark-fo-sequences",c)},b=function(e,t){var n,i=a.getSelectedDocument(),s=i.selectedLayers;if(s.isEmpty)r.showToast("Please select a layer to attach a focus item to.");else if(s.length>1)r.showToast("A focus item can only be attached to one layer or group.");else{var l=s.layers[0].getParentArtboard();if(0===e){var c=o.layerSettingForKey(l,"stark-fo-main-group"),u=i.getLayerWithID(c),d=void 0;if(u){d=w(t.name,u);var f=o.layerSettingForKey(u,"stark-fo-sequences");f.push({id:d.id,name:d.name}),o.setLayerSettingForKey(u,"stark-fo-sequences",f)}else{u=T(l),d=w(t.name,u);var h=o.documentSettingForKey(i,"stark-fo-main-groups");h||(h=[]),h.push(u.id),o.setDocumentSettingForKey(i,"stark-fo-main-groups",h),o.setLayerSettingForKey(l,"stark-fo-main-group",u.id),o.setLayerSettingForKey(u,"stark-fo-sequences",[{id:d.id,name:d.name}])}d.moveToBack();var g=C(e+1,s.layers[0],d);o.setLayerSettingForKey(g,"stark-fo-item",{associatedId:s.layers[0].id,id:g.id,name:s.layers[0].name}),n={sequenceId:d.id,id:g.id,name:s.layers[0].name}}else{var m=i.getLayerWithID(t.id);l.id!==m.getParentArtboard().id?r.showToast("Unable to add focus item to this sequence since it's on another artboard."):((g=C(e+1,s.layers[0],m)).moveToBack(),o.setLayerSettingForKey(g,"stark-fo-item",{associatedId:s.layers[0].id,id:g.id,name:s.layers[0].name}),n={id:g.id,name:s.layers[0].name})}}return n},T=function(e){return new i({name:"Stark Focus Orders",parent:e,locked:!0})},w=function(e,t){return new i({name:e,parent:t,locked:!0})},C=function(e,t,n){var r=new c(0,0,24,24),o=new i({name:e+" - "+t.name,parent:n,frame:new c(0,0,100,100)}),d=(new l({frame:{x:12,y:12,width:t.frame.width,height:t.frame.height},type:a.Types.ShapePath,name:"Dotted Line",shapeType:l.ShapeType.Rectangle,style:{borders:[{color:"#4B4B4E",fillType:s.FillType.Color,thickness:2}],borderOptions:{dashPattern:[4,2]}},parent:o}),new l({frame:r,type:a.Types.ShapePath,name:"Circle",shapeType:l.ShapeType.Oval,style:{fills:[{color:"#381FD1",fillType:s.FillType.Color}],borders:[{color:"#FFFFFF",fillType:s.FillType.Color,thickness:2}],shadows:[{color:"#00000022",blur:5,x:2,y:3,spread:1}]},parent:o})),f=new u({type:a.Types.Text,name:"Number",text:""+e,style:{fontFamily:"Helvetica",textColor:"#FFFFFF",fontSize:16,fontWeight:8,borders:[]},parent:o});f.frame.x=(d.frame.width-f.frame.width)/2,f.frame.y=(d.frame.height-f.frame.height)/2;var h=new c(0,0,100,100).changeBasis({from:t,to:t.getParentArtboard()});return o.adjustToFit(),N(o,h.x-12,h.y-12),o},N=function(e,t,n){var r=function(e){for(var t={x:0,y:0},n=e.parent;n.name&&"Artboard"!==n.type;)t.x+=n.frame.x,t.y+=n.frame.y,n=n.parent;return t}(e),o=new a.Rectangle(e.frame);o.x=t-r.x,o.y=n-r.y,e.frame=o,L(e)},L=function(e){for(var t=e.parent;t&&t.name&&"Artboard"!==t.type;)t.adjustToFit(),t=t.parent},x=function(e,t){var n=a.getSelectedDocument(),r=n.getLayerWithID(e),i=n.getLayerWithID(t);r.index=i.index,r.parent.layers.forEach((function(e,t){var n=o.layerSettingForKey(e,"stark-fo-item");n&&(e.name=r.parent.layers.length-t+" - "+n.name,e.layers[e.layers.length-1].text=""+(r.parent.layers.length-t))}))},E=function(e,t,n){var r=a.getSelectedDocument().getLayerWithID(n);if(r){r.name=e+1+" - "+t;var i=o.layerSettingForKey(r,"stark-fo-item");i.name=t,o.setLayerSettingForKey(r,"stark-fo-item",i)}},_=function(e){var t=a.getSelectedDocument().getLayerWithID(e),n=t.index,r=t.parent,i=r.layers.length;t.remove(),r.layers.forEach((function(e,t){if(e.index<n){var a=o.layerSettingForKey(e,"stark-fo-item");a&&(e.name=r.layers.length-t+" - "+a.name,e.layers[e.layers.length-1].text=""+(r.layers.length-t))}})),1===i&&r.parent.remove()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleDeleteLandmarkItem=t.handleAddLandmarkItem=t.handleLandmarksLoaded=void 0;var r=n(1),a=n(3),o=n(6),i=n(2).Group,s=n(2).Style,l=n(2).ShapePath,c=n(2).Rectangle,u=n(2).Text,d=[];t.handleLandmarksLoaded=function(){var e=r.getBrowserWindow(),t=f();if(t&&t.length>0){var n=h(t);d=n}var a={artboards:d};e.webContents.executeJavaScript("landmarksLoaded('"+JSON.stringify(a)+"')").catch(console.error)},t.handleAddLandmarkItem=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e),a=g(n.landmarkType);if(a&&a.artboardId){var o=d.find((function(e){return e.artboardId===a.artboardId}));o?o.landmarks.push({type:a.type,layerId:a.layerId,layerName:a.layerName}):d.push({artboardId:a.artboardId,artboardName:a.artboardName,landmarks:[{type:a.type,layerId:a.layerId,layerName:a.layerName}]})}var i={artboards:d};t.webContents.executeJavaScript("landmarksLoaded('"+JSON.stringify(i)+"')").catch(console.error)},t.handleDeleteLandmarkItem=function(e){var t=r.getBrowserWindow(),n=JSON.parse(e).layerId;v(n),d.forEach((function(e){var t=e.landmarks.findIndex((function(e){return e.layerId===n}));t>-1&&e.landmarks.splice(t,1)}));var a=d.findIndex((function(e){return e.landmarks.length<1}));a>-1&&d.splice(a,1);var o={artboards:d};t.webContents.executeJavaScript("landmarksLoaded('"+JSON.stringify(o)+"')").catch(console.error)};var f=function(){var e=a.getSelectedDocument();return o.documentSettingForKey(e,"stark-landmarks-artboards")||[]},h=function(e){var t=a.getSelectedDocument(),n=[],r=[];return e.forEach((function(e,a){var i=t.getLayerWithID(e);if(i){var s=o.layerSettingForKey(i,"stark-landmark-main-group");if(s){var l=t.getLayerWithID(s);if(l){var c=l.getParentArtboard(),u={artboardName:c.name,artboardId:c.id,landmarks:[]},d=[];l.layers.forEach((function(e,t){var n=o.layerSettingForKey(e,"stark-landmark-item");n&&d.push({type:n.type,layerId:n.layerId,layerName:n.layerName})})),d.reverse(),u.landmarks=d,n.push(u)}else r.push(a)}}})),r.forEach((function(t){e.splice(t,1)})),o.setDocumentSettingForKey(t,"stark-landmarks-artboards",e),n},g=function(e){try{var t=a.getSelectedDocument(),n=t.selectedLayers,i=void 0;if(n.isEmpty)r.showToast("Please select a layer to attach a landmark to.");else if(n.length>1)r.showToast("A landmark can only be attached to one layer or group.");else if(n.layers[0].getParentArtboard()){var s,l=n.layers[0].getParentArtboard(),c=o.layerSettingForKey(l,"stark-landmark-main-group"),u=t.getLayerWithID(c);if(u)s=p(e,n.layers[0],u);else{u=m(l),s=p(e,n.layers[0],u),o.setLayerSettingForKey(l,"stark-landmark-main-group",u.id);var d=o.documentSettingForKey(t,"stark-landmarks-artboards");d||(d=[]),d.push(l.id),o.setDocumentSettingForKey(t,"stark-landmarks-artboards",d)}s.moveToBack(),o.setLayerSettingForKey(s,"stark-landmark-item",{type:e,layerId:s.id,layerName:n.layers[0].name}),i={artboardId:l.id,artboardName:l.name,type:e,layerId:s.id,layerName:n.layers[0].name}}else r.showToast("A landmark must be attached to a layer in an artboard.");return i}catch(e){r.debug(e)}},m=function(e){return new i({name:"Stark Landmarks",parent:e,locked:!0})},p=function(e,t,n){var r=T(e),o=b(e),d=new c(0,0,o,20),f=new i({name:e+" - "+t.name,parent:n,frame:new c(0,0,100,100)});new l({frame:{x:12,y:12,width:t.frame.width+24,height:t.frame.height+24},type:a.Types.ShapePath,name:"Solid Line",shapeType:l.ShapeType.Rectangle,style:{borders:[{color:"#FFFFFF",fillType:s.FillType.Color,thickness:2}]},parent:f}).points.forEach((function(e){return e.cornerRadius=8})),new l({frame:{x:12,y:12,width:t.frame.width+24,height:t.frame.height+24},type:a.Types.ShapePath,name:"Dotted Line",shapeType:l.ShapeType.Rectangle,style:{borders:[{color:r.textColor,fillType:s.FillType.Color,thickness:2}],borderOptions:{dashPattern:[4,2]}},parent:f}).points.forEach((function(e){return e.cornerRadius=8}));var h=new l({frame:d,type:a.Types.ShapePath,name:"Rectangle",shapeType:l.ShapeType.Rectangle,style:{fills:[{color:r.bgColor,fillType:s.FillType.Color}],borders:[{color:"#FFFFFF",fillType:s.FillType.Color,thickness:2}]},parent:f});h.points.forEach((function(e){return e.cornerRadius=2}));var g=new u({type:a.Types.Text,name:"Type",text:""+e,style:{fontFamily:"Helvetica",textColor:r.textColor,fontSize:12,fontStyle:"normal",fontWeight:8,lineHeight:12,borders:[]},parent:f});h.frame.x=t.frame.width+24-(o-6),h.frame.y=18,g.sketchObject.setTextBehaviour(2),g.style.verticalAlignment=u.VerticalAlignment.center,g.style.alignment=u.Alignment.center,g.style.kerning=null,g.frame.width=h.frame.width,g.frame.height=h.frame.height,g.frame.x=t.frame.width+24-(o-6),g.frame.y=18;var m=new c(0,0,100,100).changeBasis({from:t,to:t.getParentArtboard()});return f.adjustToFit(),S(f,m.x-12,m.y-12),f},S=function(e,t,n){var r=function(e){for(var t={x:0,y:0},n=e.parent;n.name&&"Artboard"!==n.type;)t.x+=n.frame.x,t.y+=n.frame.y,n=n.parent;return t}(e),o=new a.Rectangle(e.frame);o.x=t-r.x,o.y=n-r.y,e.frame=o,y(e)},y=function(e){for(var t=e.parent;t&&t.name&&"Artboard"!==t.type;)t.adjustToFit(),t=t.parent},v=function(e){var t=a.getSelectedDocument(),n=t.getLayerWithID(e),r=n.parent,i=r.layers.length;if(1===i){var s=o.documentSettingForKey(t,"stark-landmarks-artboards"),l=s.findIndex((function(e){return e===r.id}));s.splice(l,1),o.setDocumentSettingForKey(t,"stark-landmarks-artboards",s)}n.remove(),1===i&&r.remove()},b=function(e){var t;switch(e){case"Aside":t=44;break;case"Main":t=39;break;case"Footer":t=50;break;case"Nav":t=34;break;case"Form":t=42;break;case"Section":t=56;break;case"Header":t=54}return t},T=function(e){var t;switch(e){case"Aside":t={bgColor:"#E5DDC3",textColor:"#56430C"};break;case"Main":t={bgColor:"#EBD7EA",textColor:"#6B2E66"};break;case"Footer":t={bgColor:"#CDE0E8",textColor:"#254961"};break;case"Nav":t={bgColor:"#CFE3C1",textColor:"#214F03"};break;case"Form":t={bgColor:"#ECD8DA",textColor:"#762E2E"};break;case"Section":t={bgColor:"#C3E5D5",textColor:"#0A502B"};break;case"Header":t={bgColor:"#DDDAEC",textColor:"#3E4073"}}return t}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.handleMinMaxButtonClicked=t.handleMessageReceivedFromSocket=t.handleMenuItemClick=void 0;var i,s=n(8),l=o(n(1)),c=n(7),u=n(3);t.handleMenuItemClick=function(e){d(e)},t.handleMessageReceivedFromSocket=function(e){var t=u.getSelectedDocument(),n=JSON.parse(e),r=t.getLayerWithID(n.layerId);r&&c.applyColorToLayer(s.ConvertRgbaToHex(n.value,!0,!0),r)},t.handleMinMaxButtonClicked=function(){var e=l.getBrowserWindow(),t=e.getTitle(),n=e.getBounds().height;40==n?l.setWindowBounds("Vision Simulator"===t?448:360,i):(i=n,l.setWindowBounds("Vision Simulator"===t?448:360,40))};var d=function(e){var t=l.getBrowserWindow();switch(e){case"Main":t.setTitle("Main"),l.setWindowBounds(360,473);break;case"Contrast":case"Check Contrast":t.setTitle("Contrast"),l.setWindowBounds(360,651);break;case"Alt-Text":t.setTitle("Alt-Text"),l.setWindowBounds(360,561);break;case"Typography":t.setTitle("Typography"),l.setWindowBounds(360,561);break;case"Touch Targets":t.setTitle("Touch Targets"),l.setWindowBounds(360,347);break;case"Focus Order":t.setTitle("Focus Order"),l.setWindowBounds(360,602);break;case"Landmarks":t.setTitle("Landmarks"),l.setWindowBounds(360,586);break;case"Vision":case"Vision Simulator":t.setTitle("Vision Simulator"),l.setWindowBounds(448,621);break;case"Settings":t.setTitle("Settings"),l.setWindowBounds(360,490);break;case"Account":t.setTitle("Account"),l.setWindowBounds(360,490);break;case"Upgrade":t.setTitle("Account"),l.setWindowBounds(360,463);break;default:t.setTitle("Main"),l.setWindowBounds(360,463)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleTouchTargetsSelectionChanged=t.handleTouchTargetsLoaded=void 0;var r=n(1),a=n(3);t.handleTouchTargetsLoaded=function(){var e=r.getBrowserWindow(),t=a.getSelectedDocument().selectedLayers,n={dimensions:{width:0,height:0}};t.isEmpty?r.showToast("Select a layer to check touch targets."):1===t.length?(n.dimensions.width=Math.trunc(t.layers[0].frame.width),n.dimensions.height=Math.trunc(t.layers[0].frame.height)):r.showToast("Too many layers to check touch targets against."),e.webContents.executeJavaScript("touchTargetsLoaded('"+JSON.stringify(n)+"')").catch(console.error)},t.handleTouchTargetsSelectionChanged=function(){var e=r.getBrowserWindow(),t=a.getSelectedDocument().selectedLayers,n={dimensions:{width:0,height:0}};t.isEmpty?r.showToast("Select a layer to check touch targets."):1===t.length?(n.dimensions.width=Math.trunc(t.layers[0].frame.width),n.dimensions.height=Math.trunc(t.layers[0].frame.height)):r.showToast("Too many layers to check touch targets against."),e.webContents.executeJavaScript("touchTargetsLoaded('"+JSON.stringify(n)+"')").catch(console.error)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleApplyFontSizeChange=t.handleTypographyItemClick=t.handleTypographyLoaded=void 0;var r=n(1),a=n(3),o=n(2);t.handleTypographyLoaded=function(){var e=r.getBrowserWindow(),t={items:[]},n=a.getSelectedDocument().selectedPage;o.find("Text",n).forEach((function(e){e.style.fontSize<12&&t.items.push({name:e.name,size:Math.trunc(e.style.fontSize),fontName:e.style.fontFamily,fontWeight:e.style.fontWeight,layerId:e.id})})),e.webContents.executeJavaScript("typographyLoaded('"+JSON.stringify(t)+"')").catch(console.error)},t.handleTypographyItemClick=function(e){var t=JSON.parse(e),n=a.getSelectedDocument(),r=n.getLayerWithID(t.layerId);n.centerOnLayer(r)},t.handleApplyFontSizeChange=function(e){var t=JSON.parse(e);a.getSelectedDocument().getLayerWithID(t.layerId).style.fontSize=t.fontSize}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleGenerate=t.handleArtboardChanged=t.handleSimulationTabLoaded=t.handleVisionSimulatorLoaded=void 0;var r=n(8),a=n(1),o=n(7),i=n(3),s=n(2).Style,l=[];t.handleVisionSimulatorLoaded=function(){var e=a.getBrowserWindow(),t=i.getSelectedDocument();l=f(t);var n=h(t);l.length<=0?a.showToast("You need at least one artboard to run the vision simulator."):!n&&t.selectedLayers.layers.length>0?a.showToast("The vision simulator can only be run on artboards."):(n||(l[0].isSelected=!0),e.webContents.executeJavaScript("visionSimulatorLoaded('"+JSON.stringify({artboards:l})+"')").catch(console.error))},t.handleSimulationTabLoaded=function(){var e=a.getBrowserWindow(),t=i.getSelectedDocument(),n=h(t)||l[0].id,r=t.getLayerWithID(n),o=g(r);e.webContents.executeJavaScript("simulationTabLoaded('"+JSON.stringify({imageData:o,sizeData:m(r)})+"')").catch(console.error)},t.handleArtboardChanged=function(e){var t=a.getBrowserWindow(),n=i.getSelectedDocument(),r=JSON.parse(e);a.debug(r);var o=n.getLayerWithID(r.artboardId);a.debug(o);var s=g(o);l.forEach((function(e){return e.isSelected=r.artboardId===e.id})),t.webContents.executeJavaScript("simulationTabLoaded('"+JSON.stringify({imageData:s,sizeData:m(o)})+"')").catch(console.error)},t.handleGenerate=function(e){var t=JSON.parse(e),n=i.getSelectedDocument().getLayerWithID(t.artboardToGenerate);d(n,t.visionSimulatorTypesSelected)};var c=function(e,t){var n=r.ConvertHexToRgba(e);return r.ConvertRgbaToRgbaString(r.SimulateColorblindness(n,t))},u=function(e,t){e.forEach((function(e){if(e.fillType===s.FillType.Color){var n=c(e.color,t);e.color=n}else e.fillType===s.FillType.Gradient&&e.gradient.stops.forEach((function(e){var n=c(e.color,t);e.color=n}))}))},d=function(e,t){var n=e.name,l=e.frame.x,d=[];t.forEach((function(t){var a=e.duplicate();a.name=n+" - "+t;var i=l+a.frame.width+100;if(a.frame.x=i,l=i,d.push(a),t===r.BLURRED)o.getChildLayers(a,!0).forEach((function(e){e.style.blur={type:s.BlurType.Gaussian,radius:1.75,enabled:!0}}));else{var f=r.GetColorblindMatrixArray(t);if(a.background&&a.background.color){var h=c(a.background.color,f);o.applyColorToLayer(h,a)}o.getChildLayers(a,!0).forEach((function(e){if(("Shape"===e.type||"ShapePath"===e.type||"Image"===e.type||"Text"===e.type)&&(u(e.style.fills,f),u(e.style.borders,f),"Text"===e.type)){var t=e.sketchObject.textColor(),n={r:255*t.red(),g:255*t.green(),b:255*t.blue(),a:t.alpha()},a=r.ConvertRgbaStringToRgba(c(r.ConvertRgbaToHex(n),f));o.applyColorToLayer(r.ConvertRgbaToHex(a,!0,!0),e)}}))}})),i.getSelectedDocument().centerOnLayer(d[0]),a.showToast(t.length+" Simulated artboard"+(t.length>1?"s":"")+" generated.")},f=function(e){var t=e.selectedPage,n=h(e),r=[],a=/'/g;return t.layers.forEach((function(e){("Artboard"===e.type||"SymbolMaster"===e.type)&&r.push({id:e.id,name:e.name.replace(a,""),isSelected:n==e.id})})),r.reverse()},h=function(e){var t;return e.selectedLayers.layers.forEach((function(e){t=e.sketchObject.parentArtboard()})),t&&(t=t.objectID()),t},g=function(e){return i.export(e,{scales:"2",formats:"png",output:!1}).toString("base64")},m=function(e){return{width:2*e.frame.width,height:2*e.frame.height}}},function(e,t){e.exports="file://"+context.plugin.urlForResourceNamed("_webpack_resources/382e82375e9410380a7dc4f1a8818864.html").path()}]);"default"===key&&"function"==typeof exports?exports(context):exports[key](context)}that.onRun=__skpm_run.bind(this,"default"),that.onSelectionChanged=__skpm_run.bind(this,"onSelectionChanged");